Metadata-Version: 2.4
Name: polars-indicator
Version: 0.1.0
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: Financial and Insurance Industry
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Rust
Classifier: Programming Language :: Python :: Implementation :: CPython
Classifier: Programming Language :: Python :: Implementation :: PyPy
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Office/Business :: Financial
Classifier: Topic :: Scientific/Engineering
Requires-Dist: numpy>=1.24.4
Requires-Dist: polars>=1.8.2
License-File: LICENSE
Summary: Technical indicators for Polars dataframes using Rust
Keywords: polars,technical-analysis,indicators,rust,finance
Author-email: Ender <codeotter0201@gmail.com>
Maintainer-email: Ender <codeotter0201@gmail.com>
License: MIT
Requires-Python: >=3.8
Description-Content-Type: text/markdown; charset=UTF-8; variant=GFM
Project-URL: Homepage, https://github.com/codeotter0201/polars_indicator
Project-URL: Repository, https://github.com/codeotter0201/polars_indicator
Project-URL: Documentation, https://github.com/codeotter0201/polars_indicator#readme
Project-URL: Issues, https://github.com/codeotter0201/polars_indicator/issues

# Polars Indicator

ä¸€å€‹é«˜æ•ˆèƒ½çš„ Polars æ’ä»¶ï¼Œä½¿ç”¨ Rust å¯¦ç¾æŠ€è¡“æŒ‡æ¨™è¨ˆç®—ï¼Œæä¾› Python å‹å¥½çš„ APIã€‚

## ç‰¹è‰²

- ðŸš€ **é«˜æ•ˆèƒ½**: Rust å¾Œç«¯å¯¦ç¾ï¼Œæ•ˆèƒ½å„ªç•°
- ðŸ **Python å‹å¥½**: ç„¡ç¸«æ•´åˆ Polars DataFrame API
- ðŸ”§ **æ˜“æ–¼ä½¿ç”¨**: ç°¡æ½”ç›´è§€çš„å‡½æ•¸ä»‹é¢
- âœ… **ç¶“éŽé©—è­‰**: å®Œæ•´çš„æ¸¬è©¦è¦†è“‹å’Œé‚Šç•Œæ¢ä»¶è™•ç†
- ðŸ“ˆ **å°ˆæ¥­ç´š**: æ”¯æ´è¤‡é›œçš„äº¤æ˜“ä¿¡è™Ÿè™•ç†

## å®‰è£

```bash
 polars as pl
pip install polars-indicator

# é–‹ç™¼ç’°å¢ƒå®‰è£
uv run maturin develop
```

## å¿«é€Ÿé–‹å§‹

### SuperTrend æŒ‡æ¨™

```python
import polars as pl
from polars_indicator import atr, supertrend, supertrend_direction

# å‰µå»ºå¸‚å ´æ•¸æ“š
df = pl.DataFrame({
    "high": [102.0, 103.5, 104.2, 103.8, 105.1],
    "low": [100.2, 101.8, 102.1, 101.9, 103.2],
    "close": [101.5, 102.8, 103.1, 102.9, 104.2],
})

# è¨ˆç®— SuperTrend æŒ‡æ¨™
result = df.with_columns([
    atr("high", "low", "close", 14).alias("atr"),
    supertrend("high", "low", "close", 14, 3.0).alias("supertrend"),
    supertrend_direction("high", "low", "close", 14, 3.0).alias("direction"),
])

print(result)
```

### äº¤æ˜“ä¿¡è™Ÿè™•ç†

```python
from polars_indicator import (
    clean_entries,
    clean_exits,
    clean_enex_position_ids
)

# å‰µå»ºäº¤æ˜“ä¿¡è™Ÿ
df = pl.DataFrame({
    "entry": [False, True, True, False, False],
    "exit": [False, False, False, True, True],
})

# æ¸…ç†ä¿¡è™Ÿä¸¦ç”ŸæˆæŒå€‰ID
result = df.with_columns([
    clean_entries("entry", "exit", True).alias("clean_entry"),
    clean_exits("entry", "exit", True).alias("clean_exit"),
    clean_enex_position_ids("entry", "exit", True).alias("position_id"),
])

print(result)
```

## å¯ç”¨å‡½æ•¸

### æŠ€è¡“æŒ‡æ¨™

- `atr(high, low, close, period=14)` - Average True Range
- `supertrend(high, low, close, atr_period=14, multiplier=3.0)` - SuperTrend è¶¨å‹¢ç·š
- `supertrend_direction(high, low, close, atr_period=14, multiplier=3.0)` - SuperTrend æ–¹å‘

### äº¤æ˜“ä¿¡è™Ÿè™•ç†

- `clean_entries(entries, exits, entry_first=True)` - æ¸…ç†é€²å ´ä¿¡è™Ÿ
- `clean_exits(entries, exits, entry_first=True)` - æ¸…ç†å‡ºå ´ä¿¡è™Ÿ
- `clean_enex_position_ids(entries, exits, entry_first=True)` - ç”ŸæˆæŒå€‰ ID
- `reshape_position_id_array(ohlcv_lens, position_id_arr, entry_idx_arr, exit_idx_arr)` - é‡å¡‘æŒå€‰æ•¸çµ„

## ç¯„ä¾‹

æŸ¥çœ‹ `example_position.py` äº†è§£å®Œæ•´çš„ä½¿ç”¨ç¯„ä¾‹ã€‚

```bash
uv run python example_position.py
```

## é–‹ç™¼

è©³ç´°çš„é–‹ç™¼æŒ‡å—è«‹åƒé–± [DEVELOPER_GUIDE.md](DEVELOPER_GUIDE.md)ã€‚

### å¿«é€Ÿé–‹ç™¼è¨­ç½®

```bash
# ç·¨è­¯ Rust ä»£ç¢¼
uv run maturin develop

# åŸ·è¡Œæ¸¬è©¦
uv run python -m pytest tests/ -v

# ä»£ç¢¼é¢¨æ ¼æª¢æŸ¥
uv run python -m ruff check .
```

## ç™¼ä½ˆåˆ° PyPI

### æº–å‚™å·¥ä½œ

åœ¨ç™¼ä½ˆä¹‹å‰ï¼Œè«‹ç¢ºä¿å·²æº–å‚™ä»¥ä¸‹è³‡è¨Šï¼š

#### 1. PyPI å¸³æˆ¶è¨­ç½®

- åœ¨ [PyPI](https://pypi.org) è¨»å†Šå¸³æˆ¶
- åœ¨ [TestPyPI](https://test.pypi.org) è¨»å†Šå¸³æˆ¶ï¼ˆç”¨æ–¼æ¸¬è©¦ï¼‰
- å•Ÿç”¨é›™å› å­é©—è­‰ï¼ˆ2FAï¼‰
- å‰µå»º API Tokenï¼š
  - ç™»å…¥ PyPI â†’ Account Settings â†’ API tokens
  - å‰µå»º token ä¸¦ä¿å­˜ï¼ˆåªæœƒé¡¯ç¤ºä¸€æ¬¡ï¼‰

#### 2. æœ¬åœ°ç’°å¢ƒé…ç½®

```bash
# å®‰è£ç™¼ä½ˆç›¸é—œä¾è³´
uv add twine --group dev

# é…ç½® PyPI èªè­‰ï¼ˆæŽ¨è–¦ä½¿ç”¨ API tokenï¼‰
# æ–¹æ³• 1: ä½¿ç”¨ .pypirc æª”æ¡ˆ
cat > ~/.pypirc << EOF
[distutils]
index-servers = pypi testpypi

[pypi]
username = __token__
password = your-api-token-here

[testpypi]
repository = https://test.pypi.org/legacy/
username = __token__
password = your-test-api-token-here
EOF

# æ–¹æ³• 2: ä½¿ç”¨ç’°å¢ƒè®Šæ•¸
export TWINE_USERNAME=__token__
export TWINE_PASSWORD=your-api-token-here
```

#### 3. å°ˆæ¡ˆæª¢æŸ¥æ¸…å–®

- [ ] æ›´æ–°ç‰ˆæœ¬è™Ÿï¼ˆåœ¨ `Cargo.toml` ä¸­ï¼‰
- [ ] æ›´æ–° `CHANGELOG.md` æˆ–ç™¼ä½ˆèªªæ˜Ž
- [ ] ç¢ºä¿æ‰€æœ‰æ¸¬è©¦é€šéŽ
- [ ] æª¢æŸ¥ `pyproject.toml` é…ç½®æ­£ç¢º
- [ ] é©—è­‰ `README.md` å…§å®¹å®Œæ•´

### ç™¼ä½ˆæ­¥é©Ÿ

#### åƒ…æ§‹å»ºï¼ˆæ¸¬è©¦ç”¨ï¼‰

```bash
# åƒ…æ§‹å»º wheelï¼Œä¸ç™¼ä½ˆ
uv run python build_and_publish.py --build-only
```

#### ç™¼ä½ˆåˆ° TestPyPIï¼ˆæ¸¬è©¦ç’°å¢ƒï¼‰

```bash
# æ§‹å»ºä¸¦ç™¼ä½ˆåˆ°æ¸¬è©¦ç’°å¢ƒ
uv run python build_and_publish.py

# æˆ–æ‰‹å‹•æŒ‡å®š TestPyPI
uv run python -m twine upload --repository testpypi target/wheels/*.whl
```

#### ç™¼ä½ˆåˆ°æ­£å¼ PyPI

```bash
# æ§‹å»ºä¸¦ç™¼ä½ˆåˆ°æ­£å¼ç’°å¢ƒ
uv run python build_and_publish.py

# é©—è­‰å®‰è£
pip install polars-indicator
```

### ç™¼ä½ˆè…³æœ¬èªªæ˜Ž

`build_and_publish.py` è…³æœ¬æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

1. **æ¸…ç†èˆŠæ§‹å»º**ï¼šè‡ªå‹•æ¸…ç† `dist/` å’Œ `target/wheels/` ç›®éŒ„
2. **æ§‹å»º wheel**ï¼šä½¿ç”¨ maturin æ§‹å»º Rust æ“´å±•
3. **ç™¼ä½ˆåˆ° PyPI**ï¼šä½¿ç”¨ twine ä¸Šå‚³åˆ° PyPI

```bash
# é¡¯ç¤ºå¹«åŠ©
uv run python build_and_publish.py --help

# åƒ…æ§‹å»º
uv run python build_and_publish.py --build-only

# æ§‹å»ºä¸¦ç™¼ä½ˆ
uv run python build_and_publish.py
```

### ç™¼ä½ˆå¾Œé©—è­‰

```bash
# æª¢æŸ¥ PyPI é é¢
# https://pypi.org/project/polars-indicator/

# æ¸¬è©¦å®‰è£
pip install --upgrade polars-indicator

# é©—è­‰åŠŸèƒ½
python -c "import polars_indicator; print('æˆåŠŸå°Žå…¥')"
```

### å¸¸è¦‹å•é¡Œ

#### èªè­‰å¤±æ•—

- ç¢ºèª API token æ­£ç¢ºè¨­ç½®
- æª¢æŸ¥ `.pypirc` æª”æ¡ˆæ ¼å¼
- ä½¿ç”¨ `twine check` é©—è­‰ wheel æª”æ¡ˆ

#### ä¸Šå‚³å¤±æ•—

- ç¢ºèªç‰ˆæœ¬è™Ÿæœªèˆ‡ç¾æœ‰ç‰ˆæœ¬è¡çª
- æª¢æŸ¥ `pyproject.toml` é…ç½®
- é©—è­‰ wheel æª”æ¡ˆå®Œæ•´æ€§

#### æ¬Šé™å•é¡Œ

- ç¢ºèª PyPI å¸³æˆ¶æœ‰å°ˆæ¡ˆä¸Šå‚³æ¬Šé™
- å°æ–¼æ–°å°ˆæ¡ˆï¼Œé¦–æ¬¡ä¸Šå‚³éœ€è¦å®Œæ•´çš„å°ˆæ¡ˆæ¬Šé™

## è²¢ç»

æ­¡è¿Žè²¢ç»ï¼è«‹é–±è®€ [DEVELOPER_GUIDE.md](DEVELOPER_GUIDE.md) äº†è§£å¦‚ä½•åƒèˆ‡é–‹ç™¼ã€‚

## è¨±å¯è­‰

MIT License

