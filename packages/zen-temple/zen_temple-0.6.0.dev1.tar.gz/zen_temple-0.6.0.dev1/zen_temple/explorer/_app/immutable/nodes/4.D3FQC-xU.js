import"../chunks/CWj6FrbW.js";import{p as we,a as o,b as P,s as h,f as K,c as ke,d as v,e as r,g as e,u as _,r as g,t as te}from"../chunks/CZBSCAq2.js";import{t as F,a as W}from"../chunks/BI1irte-.js";import{i as L}from"../chunks/DU61YhRX.js";import{F as xe,a as ae,S as Se,g as ze,b as Ce,f as De}from"../chunks/_ikFheHs.js";import{D as E}from"../chunks/Bkhakzxo.js";import{B as $e}from"../chunks/D2YGMS0m.js";import{g as f}from"../chunks/CqS7hfz2.js";var je=F('<div class="row"><div class="col-6"><!></div></div> <div class="row"><div class="col-6"><!></div></div> <div class="row"><div class="col-6"><!></div></div> <div class="row"><div class="col-6"><!></div></div>',1),Pe=F("<!> <!>",1),We=F('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),Fe=F('<div style="position: relative;"><!></div>'),Me=F('<h2>The Energy Balance</h2> <!> <div class="mt-4"><!> <!></div>',1);function Ae(re,le){we(le,!0);var M=["rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(255, 99, 132)","rgb(201, 203, 207)","rgb(220,20,60)","rgb(255,99,71)","rgb(255,69,0)","rgb(154,205,50)","rgb(0,100,0)","rgb(50,205,50)","rgb(0,139,139)","rgb(153,50,204)","rgb(255,105,180)"];let a=o(null),H=o(!1),p=o(!1),u=o(!1),O=o(P([])),m=o(null),U=o(P([])),y=o(null),z=o(P([])),w=o(null),I=o(""),R=o("");const oe=["Hourly","Daily","Weekly","Monthly"].map(s=>({label:s,value:s}));let N=o("Hourly"),B=o(P([])),Y=o(P([]));const se=_(()=>({type:"line",data:{datasets:e(B),labels:e(Y)},options:{animation:!1,normalized:!0,elements:{point:{radius:0}},responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Time"}},y:{stacked:!0,beginAtZero:!0,title:{display:!0,text:`Power [${e(I)}]`}}},borderWidth:1,plugins:{zoom:{pan:{enabled:!0,modifierKey:"ctrl",mode:"x"},zoom:{drag:{enabled:!0},wheel:{enabled:!0},mode:"x"}}},interaction:{intersect:!1,mode:"nearest",axis:"x"}}}));async function ne(){e(a)&&(r(m,e(O)[0],!0),r(y,e(U)[0],!0),r(w,e(z).length>0?e(z)[0].toString():null,!0),r(H,!1),await C())}async function C(){var b;if(r(u,!0),te(),e(m)==null||e(y)==null||e(w)==null||e(a)==null){r(u,!1);return}let s=Math.floor((Number(e(w))-e(a).detail.system.reference_year)/e(a).detail.system.interval_between_years),i=1;switch(e(N)){case"Daily":i=24;break;case"Weekly":i=168;break;case"Monthly":i=720;break}let d=await ze(e(a).solution_name,e(m),e(y),e(a).scenario_name,s,i),D=await Ce(e(a).solution_name,f("flow_export",e(a).version),e(a).scenario_name);D===null?r(I,""):r(I,D.data[0][0],!0),r(B,[],!0);let $=0;for(const c in d){let j={node:[e(m)]};if(d[c]==null||d[c].data.length==0)continue;if("technology"in d[c].data[0]){let t=[];for(const S of d[c].data)t.push(S.technology);j={technology:t}}let n={},x=De(d[c].data,j,n);if(x.length!=0)for(let t of x){if(Object.keys(t.data).length==0)continue;switch(c){case f("flow_storage_discharge",e(a).version):t.label=t.label+" (discharge)";break;case f("flow_transport_in",e(a).version):t.label=t.label+" (transport in)";break;case f("flow_import",e(a).version):t.label="Import",e(a).version;break;case f("shed_demand",e(a).version):t.label="Shed Demand";break;case f("flow_storage_charge",e(a).version):t.label=t.label+" (charge)";break;case f("flow_transport_out",e(a).version):t.label=t.label+" (transport out)";break;case f("flow_export",e(a).version):t.label="Export";break}let S="line";Object.keys(t.data).length==1&&(S="bar"),c=="demand"?(t.label="Demand",t.type="line",t.stack="ownCustomStack",t.fill=!1,t.borderColor="black",t.backgroundColor="white",t.borderWidth=2,t.stepped=!0,Object.keys(t.data).length==1&&(t.pointRadius=2)):(t.type=S,t.fill="origin",t.borderColor=M[$%M.length],t.backgroundColor=M[$%M.length].replace(")",", 1)"),t.stepped=!0,t.cubicInterpolationMode="monotone"),e(B).push(t),$++}}r(Y,Object.keys(e(B)[0].data),!0),r(u,!1),r(H,!0),await te();let k=e(a).solution_name.split(".");r(R,[k[(k==null?void 0:k.length)-1],(b=e(a))==null?void 0:b.scenario_name,"balance",e(y),e(m),e(w)].join("_"),!0)}var Z=Me(),q=h(K(Z),2);xe(q,{children:(s,i)=>{var d=Pe(),D=K(d);ae(D,{title:"Solution Selection",children:(b,c)=>{const j=_(()=>e(u)||e(p));Se(b,{solution_selected:ne,get disabled(){return e(j)},get carriers(){return e(U)},set carriers(n){r(U,n,!0)},get nodes(){return e(O)},set nodes(n){r(O,n,!0)},get years(){return e(z)},set years(n){r(z,n,!0)},get selected_solution(){return e(a)},set selected_solution(n){r(a,n,!0)},get loading(){return e(p)},set loading(n){r(p,n,!0)}})}});var $=h(D,2);{var k=b=>{ae(b,{title:"Data Selection",children:(c,j)=>{var n=je(),x=K(n),t=v(x),S=v(t);const ce=_(()=>e(z).map(l=>({label:l.toString(),value:l.toString()}))),ve=_(()=>e(u)||e(p));E(S,{label:"Year",get options(){return e(ce)},get disabled(){return e(ve)},onUpdate:C,get value(){return e(w)},set value(l){r(w,l,!0)}}),g(t),g(x);var T=h(x,2),Q=v(T),ge=v(Q);const _e=_(()=>e(O).map(l=>({label:l,value:l}))),pe=_(()=>e(u)||e(p));E(ge,{label:"Node",get options(){return e(_e)},get disabled(){return e(pe)},onUpdate:C,get value(){return e(m)},set value(l){r(m,l,!0)}}),g(Q),g(T);var A=h(T,2),V=v(A),be=v(V);const fe=_(()=>e(U).map(l=>({label:l,value:l}))),me=_(()=>e(u)||e(p));E(be,{label:"Carrier",get options(){return e(fe)},get disabled(){return e(me)},onUpdate:C,get value(){return e(y)},set value(l){r(y,l,!0)}}),g(V),g(A);var X=h(A,2),ee=v(X),he=v(ee);const ye=_(()=>e(u)||e(p));E(he,{label:"Smoothing Window Size",options:oe,get disabled(){return e(ye)},onUpdate:C,get value(){return e(N)},set value(l){r(N,l,!0)}}),g(ee),g(X),W(c,n)}})};L($,b=>{!e(p)&&e(a)&&b(k)})}W(s,d)}});var G=h(q,2),J=v(G);{var ie=s=>{var i=We();W(s,i)};L(J,s=>{e(u)&&s(ie)})}var de=h(J,2);{var ue=s=>{var i=Fe(),d=v(i);$e(d,{get config(){return e(se)},get plot_name(){return e(R)},zoom:!0}),g(i),W(s,i)};L(de,s=>{!e(u)&&e(H)&&s(ue)})}g(G),W(re,Z),ke()}export{Ae as component};
