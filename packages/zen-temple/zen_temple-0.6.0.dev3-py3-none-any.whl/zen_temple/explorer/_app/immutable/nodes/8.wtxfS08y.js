import"../chunks/CWj6FrbW.js";import{p as Ye,a as r,b as U,s as k,f as W,c as Le,e as t,g as e,u as Y,r as X,i as ke,d as ee,t as Oe}from"../chunks/CZBSCAq2.js";import{s as qe}from"../chunks/BkjlwMHH.js";import{i as g}from"../chunks/DU61YhRX.js";import{e as Ge,i as He}from"../chunks/BZZDM9jF.js";import{t as _,a as d}from"../chunks/BI1irte-.js";import{d as Ie}from"../chunks/DqKNatLn.js";import{F as Je,a as de,S as Ke,d as Me,e as Qe,f as We}from"../chunks/B_NxvH-n.js";import{A as _e}from"../chunks/jwpG3-Am.js";import{R as ve}from"../chunks/DUHsI0Vn.js";import{B as Xe}from"../chunks/CUJTTmIk.js";import{D as ze}from"../chunks/b7t0L-pa.js";async function Ze(ge,ne,se,p,P,ie,f,b){t(ne,null),t(se,[],!0),await p(),P(),ie(),f(),b()}var $e=_("<option> </option>"),et=_("<!> <!>",1),tt=_('<h3>Variable</h3> <select class="form-select"></select> <!> <!>',1),at=_('<div class="row"><div class="col-6"><!></div> <div class="col-6"><!></div></div> <!> <!>',1),rt=_("<!> <!>",1),lt=_("<!> <!>",1),ot=_('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),nt=_('<div class="text-center">No technologies with this selection.</div>'),st=_('<div class="text-center">No carriers with this selection.</div>'),it=_('<div class="text-center">No solution selected.</div>'),ct=_('<div class="text-center">No data with this selection.</div>'),ut=_('<div class="text-center">No locations with this selection.</div>'),dt=_('<div class="text-center">No data with this selection.</div>'),_t=_('<h2>Capacity</h2> <!> <div class="mt-4"><!></div>',1);function Ut(ge,ne){Ye(ne,!0);let se=["conversion","storage","transport"],p=r(null),P=r(null),ie=["capacity","capacity_addition"],f=r(U([])),b=r(U([])),Z=r(U([])),z=r(U([])),s=r(null),Pe=U(["technology","node"]);const Fe=["not_normalized","normalized"],pe=["energy","power"];let T=r("capacity"),L=r(null),te=r("energy"),K=r("technology"),h=r("conversion"),j=r(U([])),M=r(U([])),B=r(U([])),ae=r("not_normalized"),F=r(!1),A=r(!1),fe=r(""),ce=r(U([])),he=r(U([])),ye=r(U({})),Ae=Y(()=>{const a=e(h)=="storage"?e(te):"power";return e(ye)[e(z)[0]+"_"+a]||""}),Ce=Y(()=>({type:"bar",data:{datasets:e(ce),labels:e(he)},options:{responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:`${e(T)} [${e(Ae)}]`}}},interaction:{intersect:!1,mode:"nearest",axis:"x"}}}));function re(){t(ae,"not_normalized"),t(B,e(b),!0),t(j,e(z),!0),t(M,e(Z),!0),t(K,"node")}async function me(){var o;if(t(A,!0),t(p,null),await Oe(),e(T)===null||e(s)===null){t(A,!1);return}const a=await Qe(e(s).solution_name,e(T),e(s).scenario_name,e(s).detail.system.reference_year,e(s).detail.system.interval_between_years);t(p,a.data,!0),(o=a.unit)!=null&&o.data&&t(ye,Object.fromEntries(a.unit.data.map(n=>[n.technology+"_"+n.capacity_type,n[0]||n.units])),!0),t(A,!1)}async function De(){t(p,null),t(L,null),t(P,null),await me(),xe(),oe(),le(),re(),C()}function be(){xe(),oe(),le(),re(),C()}function Ee(){oe(),le(),re(),C()}function xe(){if(t(f,[],!0),e(p)===null||e(h)===null)return;let a=we();e(p).data.forEach(o=>{let n=o.technology,y=e(s).detail.reference_carrier[n];!e(f).includes(y)&&a.includes(o.technology)&&e(f).push(y)}),e(f).length>0&&t(L,e(f)[0],!0)}function le(){e(p)!==null&&(t(b,[],!0),e(p).data.forEach(a=>{let o=a.technology,n=e(s).detail.reference_carrier[o];e(z).includes(a.technology)&&!e(b).includes(a.location)&&e(b).push(a.location),!e(f).includes(n)&&e(z).includes(a.technology)&&e(f).push(n)}),t(B,e(b),!0))}function we(){if(!e(s)||!e(h))return[];switch(e(h)){case"conversion":return e(s).detail.system.set_conversion_technologies;case"storage":return e(s).detail.system.set_storage_technologies;case"transport":return e(s).detail.system.set_transport_technologies}return[]}function oe(){if(e(h)===null)return;let a=we();t(z,a.filter(o=>{var n;return((n=e(s))==null?void 0:n.detail.reference_carrier[o])==e(L)}),!0),t(j,e(z),!0)}function C(){var x;if(e(K)=="technology"?t(B,e(b),!0):t(j,e(z),!0),e(T)==null||e(B).length==0||e(M).length==0||e(j).length==0||e(p)===null){t(P,null);return}let a={},o={};e(K)=="technology"?(a.location=e(B),o.technology=e(j)):(a.technology=e(j),o.location=e(B)),e(h)=="storage"?o.capacity_type=[e(te)]:o.capacity_type=pe;let n=e(Z).filter(D=>!e(M).includes(D));t(P,We(e(p).data,a,o,n,e(ae)=="normalized"),!0),t(ce,e(P),!0),t(he,e(M).map(D=>D.toString()),!0);let y=e(s).solution_name.split(".");t(fe,[y[(y==null?void 0:y.length)-1],(x=e(s))==null?void 0:x.scenario_name,e(T),e(h),e(L)].join("_"),!0)}var Ne=_t(),Se=k(W(Ne),2);Je(Se,{children:(a,o)=>{var n=lt(),y=W(n);de(y,{title:"Solution Selection",children:(O,$)=>{const w=Y(()=>e(A)||e(F));Ke(O,{solution_selected:De,get disabled(){return e(w)},get years(){return e(Z)},set years(N){t(Z,N,!0)},get selected_solution(){return e(s)},set selected_solution(N){t(s,N,!0)},get loading(){return e(F)},set loading(N){t(F,N,!0)}})}});var x=k(y,2);{var D=O=>{var $=rt(),w=W($);de(w,{title:"Variable Selection",children:(q,E)=>{var G=tt(),S=k(W(G),2);S.__change=[Ze,P,ce,me,oe,le,re,C],Ge(S,21,()=>ie,He,(u,i)=>{var c=$e(),v={},I=ee(c,!0);X(c),ke(()=>{v!==(v=e(i))&&(c.value=(c.__value=e(i))??""),qe(I,e(i))}),d(u,c)}),X(S);var R=k(S,2);{var m=u=>{var i=et(),c=W(i);const v=Y(()=>se.map(V=>({label:V,value:V}))),I=Y(()=>e(A)||e(F));ze(c,{label:"Technology Type",get options(){return e(v)},get disabled(){return e(I)},onUpdate:be,get value(){return e(h)},set value(V){t(h,V,!0)}});var l=k(c,2);{var J=V=>{const Re=Y(()=>e(A)||e(F));ve(V,{label:"",options:pe,onUpdate:be,get disabled(){return e(Re)},get value(){return e(te)},set value(Ve){t(te,Ve,!0)}})};g(l,V=>{e(h)=="storage"&&V(J)})}d(u,i)};g(R,u=>{e(T)!=null&&u(m)})}var H=k(R,2);{var Q=u=>{const i=Y(()=>e(f).map(v=>({label:v,value:v}))),c=Y(()=>e(A)||e(F));ze(u,{label:"Carrier",get options(){return e(i)},get disabled(){return e(c)},onUpdate:Ee,get value(){return e(L)},set value(v){t(L,v,!0)}})};g(H,u=>{e(h)!=null&&e(f).length>0&&u(Q)})}ke(()=>S.disabled=e(A)||e(F)),Me(S,()=>e(T),u=>t(T,u)),d(q,G)}});var N=k(w,2);{var ue=q=>{de(q,{title:"Data Selection",children:(E,G)=>{var S=at(),R=W(S),m=ee(R),H=ee(m);ve(H,{label:"Aggregation",get options(){return Pe},onUpdate:C,get value(){return e(K)},set value(l){t(K,l,!0)}}),X(m);var Q=k(m,2),u=ee(Q);ve(u,{label:"Normalisation",options:Fe,onUpdate:C,get value(){return e(ae)},set value(l){t(ae,l,!0)}}),X(Q),X(R);var i=k(R,2);{var c=l=>{_e(l,{label:"Technology",get elements(){return e(z)},onUpdate:C,get value(){return e(j)},set value(J){t(j,J,!0)}})},v=l=>{_e(l,{label:"Node",get elements(){return e(b)},onUpdate:C,get value(){return e(B)},set value(J){t(B,J,!0)}})};g(i,l=>{e(K)=="technology"?l(c):l(v,!1)})}var I=k(i,2);_e(I,{label:"Year",get elements(){return e(Z)},onUpdate:C,get value(){return e(M)},set value(l){t(M,l,!0)}}),d(E,S)}})};g(N,q=>{e(p)&&e(h)&&e(L)&&e(z).length>0&&e(b).length>0&&q(ue)})}d(O,$)};g(x,O=>{!e(F)&&e(s)&&O(D)})}d(a,n)}});var Ue=k(Se,2),Te=ee(Ue);{var je=a=>{var o=ot();d(a,o)},Be=(a,o)=>{{var n=x=>{var D=nt();d(x,D)},y=(x,D)=>{{var O=w=>{var N=st();d(w,N)},$=(w,N)=>{{var ue=E=>{var G=it();d(E,G)},q=(E,G)=>{{var S=m=>{var H=ct();d(m,H)},R=(m,H)=>{{var Q=i=>{var c=ut();d(i,c)},u=(i,c)=>{{var v=l=>{var J=dt();d(l,J)},I=l=>{Xe(l,{get config(){return e(Ce)},get plot_name(){return e(fe)}})};g(i,l=>{e(P).length==0?l(v):l(I,!1)},c)}};g(m,i=>{e(b).length==0?i(Q):i(u,!1)},H)}};g(E,m=>{e(P)==null?m(S):m(R,!1)},G)}};g(w,E=>{e(s)==null?E(ue):E(q,!1)},N)}};g(x,w=>{e(f).length==0?w(O):w($,!1)},D)}};g(a,x=>{e(z).length==0?x(n):x(y,!1)},o)}};g(Te,a=>{e(F)||e(A)?a(je):a(Be,!1)})}X(Ue),d(ge,Ne),Le()}Ie(["change"]);export{Ut as component};
