(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[546],{7447:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/training",function(){return t(5863)}])},759:function(e,n,t){"use strict";var r=t(5893);t(7294);var i=t(8659),a=t(6350),o=t(9603),s=t(9417),l=t(485),c=t.n(l);n.Z=e=>(0,r.jsx)(i.Z,{placement:e.placement||"right",delay:{show:100,hide:1e3},overlay:n=>(0,r.jsx)(a.Z,{...n,children:e.tooltipContent}),children:e.children||(0,r.jsx)(o.G,{className:c().infoTooltip,icon:s.Fuz})})},7375:function(e,n,t){"use strict";var r=t(4184),i=t.n(r),a=t(7294),o=t(7400),s=t(5893);let l=a.forwardRef((e,n)=>{let{bsPrefix:t,fluid:r=!1,as:a="div",className:l,...c}=e,d=(0,o.vE)(t,"container");return(0,s.jsx)(a,{ref:n,...c,className:i()(l,r?"".concat(d).concat("string"==typeof r?"-".concat(r):"-fluid"):d)})});l.displayName="Container",n.Z=l},5863:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return O}});var r=t(5893),i=t(7294),a=t(6720),o=t(8070),s=t(7375),l=t(7317),c=t(6062),d=t(9101),u=t(8228),h=t(1348),m=t(5567),x=e=>e.error?(0,r.jsx)("div",{style:{color:"#EC7063",fontSize:"0.9em"},children:e.error}):null,j=t(7765),p=t(7235),f=t(575),b=t(1749),g=t(7407),v=t(1664),y=t.n(v),N=t(9603),T=t(9417),Z=t(9693),_=t(403),w=t(59),E=t.n(w),M=e=>{let{modelName:n,trainAnother:t}=e,o=n+".eq",s=(0,m.T)(),l=(0,m.C)(e=>e.uiSettings.serverUrl),c=()=>{(0,_.oe)("".concat(l).concat(Z.Z.API_DOWNLOAD_MODEL,"/").concat(o),"".concat(o)).catch(e=>{s((0,h.K4)({body:e.message,canClose:!0,header:"Error Downloading Model"}))})};return(0,r.jsx)(i.Fragment,{children:(0,r.jsx)("div",{id:E().trainSuccess,children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{children:[(0,r.jsx)("pre",{style:{marginTop:"1rem"},children:o})," Trained Successfully!"]}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)(y(),{href:"".concat(Z.Z.LANDING,"?modelName=").concat(o),children:(0,r.jsxs)(a.Z,{variant:"primary",children:["Analyze files with this Model ",(0,r.jsx)(N.G,{icon:T.J9Y})]})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)(y(),{href:"".concat(Z.Z.MODEL_SUMMARY_PAGE,"/").concat(o),children:(0,r.jsxs)(a.Z,{variant:"primary",children:["See Model Summary ",(0,r.jsx)(N.G,{icon:T.Xgz})]})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsxs)(a.Z,{variant:"primary",onClick:e=>c(),children:["Download Model ",(0,r.jsx)(N.G,{icon:T.q7m})]}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsxs)(a.Z,{variant:"secondary",onClick:e=>t(),children:["Train Another Model ",(0,r.jsx)(N.G,{icon:T.XSV})]}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)(y(),{href:Z.Z.DOWNLOAD_PAGE,children:(0,r.jsxs)(a.Z,{variant:"secondary",children:["See All Models on Server ",(0,r.jsx)(N.G,{icon:T.t5N})]})})]})})})},C=t(1097),S=t(1163),D=t(759),k=t(4184),q=t.n(k),G=t(7400);let I=i.forwardRef((e,n)=>{let{bsPrefix:t,size:i,vertical:a=!1,className:o,role:s="group",as:l="div",...c}=e,d=(0,G.vE)(t,"btn-group"),u=d;return a&&(u="".concat(d,"-vertical")),(0,r.jsx)(l,{...c,ref:n,role:s,className:q()(o,u,i&&"".concat(d,"-").concat(i))})});I.displayName="ButtonGroup";var L=()=>{let[e,n]=(0,i.useState)(1e4),[t,v]=(0,i.useState)(!0),[y,N]=(0,i.useState)(0),[T,Z]=(0,i.useState)(""),[_,w]=(0,i.useState)("EquineGP"),[k,q]=(0,i.useState)([]),[G,L]=(0,i.useState)(""),[O,U]=(0,i.useState)(null),F=(0,i.useMemo)(()=>""===T.trim()?"Model Name must be meaningful":["*","/","\\"].some(e=>T.indexOf(e)>=0)?"Model Name name cannot contain * or slashes":"",[T]),P=isNaN(e)?"Invalid number of episodes to train for":"",A=(0,m.C)(e=>e.uiSettings.serverUrl),R=(0,m.T)(),B=(0,i.useCallback)(e=>R((0,h.K4)(e)),[R]),z=(0,S.useRouter)(),X=(0,i.useMemo)(()=>"string"==typeof z.query.retrainModelName?z.query.retrainModelName:"",[z.query.retrainModelName]);(0,i.useEffect)(()=>{},[R,B,T,X,A]);let Y=(0,i.useRef)(new Date().getTime());(0,i.useEffect)(()=>(0,j.Z)("Training"),[]);let{canStartTraining:K,buttonText:W}=F?{canStartTraining:!1,buttonText:"Model Name Error"}:""===G?{canStartTraining:!1,buttonText:"Upload Model File"}:0===k.length?{canStartTraining:!1,buttonText:"Upload Labeled Data Files"}:{canStartTraining:!0,buttonText:X?"Retrain!":"Start Training!"},{data:Q,mutate:H,reset:J}=(0,u.D)({mutationFn:async()=>{if(!K||!G)return!1;await (0,p.Z)(G===g.c?O:null,k);let n={embedModelName:null!==O&&G===g.c?O.name:G,episodes:e,newModelName:T,embOutDim:t?0:y,sampleFilenames:k.map(e=>e.name),trainModelType:_};if(Y.current=new Date().getTime(),X)return!1;{B({canClose:!1,header:"Training..."});let e=await (0,b.ZP)(f.B4,n)();if(R((0,h.Mr)()),!e.startTraining.success)throw Error("Training was not successful");return e.startTraining.success}},onError:e=>{R((0,h.K4)({body:e.message,canClose:!0,header:"Error During Training"}))}}),V=(0,i.useCallback)(()=>{var e;Z(X?"".concat(X.replace(/\.[^/.]+$/,"")," - Retrained ").concat((e=new Date,"".concat(e.getMonth()+1,"-").concat(e.getDate(),"-").concat(e.getFullYear()))):"My New Model"),J(),q([])},[J,X]);return(0,i.useEffect)(V,[V]),(0,r.jsx)("div",{id:E().training,children:Q?(0,r.jsx)(M,{modelName:T,trainAnother:V}):(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)("h3",{children:X?'Retrain "'.concat(X,'"'):"Train an EQUI(NE)\xb2 Model"}),(0,r.jsx)("br",{}),(0,r.jsxs)(s.Z,{children:[(0,r.jsxs)(d.Z,{children:[(0,r.jsxs)(o.Z,{sm:12,lg:6,children:[(0,r.jsxs)(l.Z.Group,{controlId:"newModelName",children:[(0,r.jsx)(l.Z.Label,{children:"New Model Name"}),(0,r.jsx)(l.Z.Control,{isInvalid:F.length>0,onChange:e=>Z(e.target.value),placeholder:"Model Name",type:"text",value:T}),(0,r.jsx)(x,{error:F})]}),(0,r.jsx)("br",{}),(0,r.jsxs)(l.Z.Group,{controlId:"trainModelType",children:[(0,r.jsx)(l.Z.Label,{children:"Model Type"}),(0,r.jsxs)(l.Z.Control,{as:"select",value:_,onChange:e=>w(e.target.value),children:[(0,r.jsx)("option",{value:"EquineProtonet",children:"Equine Protonet"}),(0,r.jsx)("option",{value:"EquineGP",children:"Equine Gaussian Processes"})]})]}),(0,r.jsx)("br",{})]}),(0,r.jsxs)(o.Z,{sm:12,lg:6,children:[(0,r.jsxs)(l.Z.Group,{controlId:"episodes",children:[(0,r.jsx)(l.Z.Label,{children:"Episodes"}),(0,r.jsx)(l.Z.Control,{isInvalid:isNaN(e),onChange:e=>n(parseInt(e.target.value)),placeholder:"Episodes",step:1,type:"number",value:e}),(0,r.jsx)(x,{error:P})]}),(0,r.jsx)("br",{}),(0,r.jsxs)(l.Z.Group,{controlId:"embOutDim",children:[(0,r.jsxs)(l.Z.Label,{children:["Embedding Output Dimension \xa0",(0,r.jsx)(D.Z,{placement:"top",tooltipContent:(0,r.jsxs)("p",{style:{paddingBottom:0},children:["This is the number of deep features from the feature embedding. You can let the server auto detect your embedding output dimension or set a custom value. Documentation is ",(0,r.jsx)("a",{href:"EquineGP"===_?"https://mit-ll-responsible-ai.github.io/equine/reference/equine/equine_gp/":"https://mit-ll-responsible-ai.github.io/equine/reference/equine/equine_protonet/",target:"_blank",children:"here"})]})})]}),(0,r.jsx)("br",{}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)(I,{"aria-label":"Embedding Output Dimension",children:[(0,r.jsx)(a.Z,{variant:t?"secondary":"outline-secondary",onClick:()=>{v(!0)},children:"Auto Detect"}),(0,r.jsx)(a.Z,{variant:t?"outline-secondary":"secondary",onClick:()=>{v(!1)},children:"Custom"})]}),!t&&(0,r.jsx)(l.Z.Control,{isInvalid:isNaN(y),onChange:e=>N(parseInt(e.target.value)),placeholder:"Episodes",step:1,min:0,type:"number",value:y,style:{display:"inline-block",width:"calc(100% - 205px)"}})]}),(0,r.jsx)(x,{error:isNaN(y)?"Number of Input Features must be a number":""})]})]})]}),(0,r.jsx)("hr",{}),(0,r.jsx)(g.Z,{customUploadText:"Upload my own .jit file",modelExtension:".jit",modelName:G,setModelName:L,setUploadModelFile:U,showTrainModelButton:!1,uploadModelFile:O,title:"Select existing .jit Model File"}),(0,r.jsx)("br",{}),(0,r.jsx)(c.Z,{children:"Upload Labeled Data Files"}),(0,r.jsx)("p",{children:'Note that if you upload a .csv file, your headings MUST contain a column with the heading "label"'}),(0,r.jsx)(C.Z,{sampleFiles:k,setSampleFiles:q,title:"Upload Labeled Data"}),(0,r.jsx)("hr",{})]}),(0,r.jsx)("div",{id:E().submitButtonContainer,children:(0,r.jsx)(a.Z,{variant:"primary",disabled:!K,onClick:()=>H(),children:W})})]})})};function O(){return(0,r.jsx)(L,{})}},403:function(e,n,t){"use strict";async function r(e){if(!e.ok)throw Error(await e.text()||e.statusText||e.status.toString());return e}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data.json",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data:text/json;charset=utf-8";o(new Blob([e],{type:t}),n)}function a(e,n){return fetch(e).then(r).then(e=>e.blob()).then(e=>{o(e,n)}).catch(e=>{throw e})}function o(e,n){!function(e,n){let t=document.createElement("a");t.href=e,t.download=n,document.body.appendChild(t),t.click(),setTimeout(function(){document.body.removeChild(t),window.URL.revokeObjectURL(e)},0)}(window.URL.createObjectURL(e),n)}t.d(n,{r9:function(){return i},oe:function(){return a}})},485:function(e){e.exports={infoTooltip:"InfoTooltip_infoTooltip__XHOEb"}},59:function(e){e.exports={training:"Training_training__xSvop",labelsContainer:"Training_labelsContainer__3kqkP",row:"Training_row__za_5d",submitButtonContainer:"Training_submitButtonContainer__W821Z",trainSuccess:"Training_trainSuccess__QB1bd"}}},function(e){e.O(0,[192,420,743,402,888,774,179],function(){return e(e.s=7447)}),_N_E=e.O()}]);