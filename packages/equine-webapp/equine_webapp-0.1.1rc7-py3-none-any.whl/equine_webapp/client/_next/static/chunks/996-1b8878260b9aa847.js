(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[996],{759:function(e,t,n){"use strict";var r=n(5893);n(7294);var l=n(8659),i=n(6350),s=n(9603),a=n(9417),o=n(485),c=n.n(o);t.Z=e=>(0,r.jsx)(l.Z,{placement:e.placement||"right",delay:{show:100,hide:1e3},overlay:t=>(0,r.jsx)(i.Z,{...t,children:e.tooltipContent}),children:e.children||(0,r.jsx)(s.G,{className:c().infoTooltip,icon:a.Fuz})})},2105:function(e,t,n){"use strict";n.d(t,{Z:function(){return b}});var r=n(5893),l=n(7294),i=n(92),s=n(6299),a=n(759),o=n(7848);function c(e){return"Image"===e.inputDataType?(0,r.jsx)(p,{...e}):(0,r.jsx)(d,{...e})}function p(e){let{dataIndex:t,getInferenceSampleImageSrc:n,getSupportExampleImageSrc:l}=e;if(n&&l){let e="The RenderInputAsImage component expects either getInferenceSampleImageSrc or getSupportExampleImageSrc props to be defined, but not both to be defined";return console.warn(e),(0,r.jsx)("p",{children:e})}if(n)return(0,r.jsx)("img",{src:n(t),alt:"inference sample"});if(l)return(0,r.jsx)("img",{src:l(t),alt:"support example"});{let e="The RenderInputAsImage component expects either getInferenceSampleImageSrc or getSupportExampleImageSrc props to be defined, but both are undefined";return console.warn(e),(0,r.jsx)("p",{children:e})}}function d(e){let{dataIndex:t,getInferenceSampleTabularData:n,getSupportExampleTabularData:l}=e,{data:i,error:s,isLoading:a}=(0,o.a)({queryKey:[n?"renderInferenceFeatureData-".concat(t):"renderSupportFeatureData-".concat(t)],queryFn:async()=>{var e,r;if(!n||!l)return n?null===(e=await n(t))||void 0===e?void 0:e.renderInferenceFeatureData:l?null===(r=await l(t))||void 0===r?void 0:r.renderSupportFeatureData:void 0}});if(a)return(0,r.jsx)("p",{children:"Loading..."});if(i){let e=i.columnHeaders.reduce((e,t,n)=>(n<i.featureData.length&&(e[t]=parseFloat(i.featureData[n].toFixed(2))),e),{});return(0,r.jsx)("pre",{children:JSON.stringify(e,void 0,2)})}if(s){if(s instanceof Error)return(0,r.jsx)("p",{children:s.message})}else if(n&&l){let e="The QueryAndRenderInputAsTabular component expects either getInferenceSampleTabularData or getSupportExampleTabularData props to be defined, but not both to be defined";return console.warn(e),(0,r.jsx)("p",{children:e})}else if(!n&&!l){let e="The QueryAndRenderInputAsTabular component expects either getInferenceSampleTabularData or getSupportExampleTabularData props to be defined, but both are undefined";return console.warn(e),(0,r.jsx)("p",{children:e})}return(0,r.jsx)("p",{children:"Something in the component went wrong"})}var u=n(3275),x=n.n(u);let h=(0,i.l49)(),m=e=>e.x,g=e=>e.y,f=e=>e.weight;function b(e){let{continuity:t,getInferenceSampleImageSrc:n,getInferenceSampleTabularData:o,getSupportExampleImageSrc:c,getSupportExampleTabularData:p,height:d=400,inDistributionThreshold:u,inputDataType:b,maxWidth:S=500,stress:D,processedClassesProbabilities:_,samples:k,scree:C,srho:M,structuredEmbeddings:A,thresholds:N=10,trustworthiness:F,prototypeSupportEmbeddings:R}=e,[U,O]=(0,l.useState)(S),P=(0,l.useRef)(null),q=(0,l.useRef)(null);(0,l.useEffect)(()=>{P.current=new ResizeObserver(e=>{window.requestAnimationFrame(()=>{Array.isArray(e)&&e.length&&O(Math.min(S,e[0].contentRect.width-400))})})},[]),(0,l.useEffect)(()=>(P.current&&q.current&&P.current.observe(q.current),()=>{var e;return null===(e=P.current)||void 0===e?void 0:e.disconnect()}),[P.current,q.current]);let{domainX:z,domainY:Q}=(0,l.useMemo)(()=>{let e=[0,0],t=[0,0];return A.labels.forEach((n,r)=>{I(e,t,m(n.prototype),g(n.prototype),0===r),n.trainingExamples.forEach(n=>I(e,t,m(n),g(n)))}),A.samples.forEach(n=>{I(e,t,m(n),g(n))}),{domainX:e,domainY:t}},[A]),{rangeX:Z,rangeY:Y,usedWidth:B}=(0,l.useMemo)(()=>{let e=(z[1]-z[0])/(Q[1]-Q[0]),t=Math.min(U-10-40,(d-30-10)*e),n=t/e;return{rangeX:[40,40+t],rangeY:[10+n,10],usedHeight:n,usedWidth:t}},[z,Q,d,U]),L=(0,l.useMemo)(()=>(0,i.BYU)().domain(z).range(Z),[z,Z]),W=(0,l.useMemo)(()=>(0,i.BYU)().domain(Q).range(Y),[Q,Y]),X=(0,s.Z)(),G=(0,l.useRef)(null);(0,l.useEffect)(()=>{var e;let t=(0,i.LLu)(L).ticks(Math.max(5,B/100));null===(e=G.current)||void 0===e||e.replaceChildren(),(0,i.Ys)(G.current).append("g").call(t)},[L,B]);let H=(0,l.useRef)(null);(0,l.useEffect)(()=>{var e;let t=(0,i.y4O)(W).ticks(5);null===(e=H.current)||void 0===e||e.replaceChildren(),(0,i.Ys)(H.current).append("g").call(t)},[W]);let J=(0,l.useMemo)(()=>A.labels.map((e,t)=>[e.prototype].concat(e.trainingExamples)).map((e,t)=>(0,i._K_)().size([U,d]).cellSize(4).thresholds(N).bandwidth(40).weight(f).x(m).y(g)(e.map(e=>({weight:f(e),x:L(m(e)),y:W(g(e))})))),[d,L,W,A,N,U]),K=J.map((e,t)=>(0,i.BYU)().domain([0,e.length]).range([.08,.5])),[$,V]=(0,l.useState)(null),[ee,et]=(0,l.useState)(null),en=(0,l.useCallback)((e,t,n)=>{et({msg:n,x:e,y:t})},[k]),er=(0,l.useCallback)((e,t,n)=>{(!k||k.length>1)&&V({msg:n,x:e,y:t})},[k]);return(0,l.useEffect)(()=>{if(R&&A.labels.length>0){if(u&&_&&k){if(V(w({sampleIndex:0,getInferenceSampleImageSrc:n,getInferenceSampleTabularData:o,inputDataType:b,processedClassesProbabilities:_,samples:k,scaleX:L,scaleY:W,structuredEmbeddings:A})),(null==k?void 0:k.length)>1)et(w({sampleIndex:1,getInferenceSampleImageSrc:n,getInferenceSampleTabularData:o,inputDataType:b,processedClassesProbabilities:_,samples:k,scaleX:L,scaleY:W,structuredEmbeddings:A}));else{let e=k[0],{closestLabelIdx:t,closestPointIdx:n}=R.getPrototypeSupportEmbeddings.reduce((t,n,r)=>(n.trainingExamples.forEach((n,l)=>{let i=Math.hypot(...n.coordinates.map((t,n)=>t-e.coordinates[n]));(null===t.closestDistance||t.closestDistance>i)&&(t.closestDistance=i,t.closestLabelIdx=r,t.closestPointIdx=l)}),t),{closestLabelIdx:null,closestPointIdx:null,closestDistance:null});null!==t&&null!==n&&et(T({getSupportExampleImageSrc:c,getSupportExampleTabularData:p,inputDataType:b,labelIdx:t,pointIdx:n,scaleX:L,scaleY:W,structuredEmbeddings:A,prototypeSupportEmbeddings:R}))}}else{let e={getSupportExampleImageSrc:c,getSupportExampleTabularData:p,inputDataType:b,scaleX:L,scaleY:W,structuredEmbeddings:A,prototypeSupportEmbeddings:R};V(T({labelIdx:0,pointIdx:0,...e})),et(T({labelIdx:1,pointIdx:0,...e}))}}},[n,o,c,p,u,b,_,k,L,W,A,R]),(0,r.jsxs)("div",{className:x()["uq-viz-container"],ref:q,children:[(0,r.jsx)("div",{className:x()["uq-viz-sidebar"],style:{marginRight:"1rem"},children:$&&$.msg}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{style:{position:"relative"},children:[(0,r.jsxs)("svg",{style:{width:U,height:d},children:[(0,r.jsx)("g",{className:"xAxis",ref:G,transform:"translate(0,".concat(d-20,")")}),(0,r.jsx)("g",{className:"yAxis",ref:H,transform:"translate(30,0)"}),J.map((e,t)=>{let n=X(null==R?void 0:R.getPrototypeSupportEmbeddings[t].label),l=K[t];return e.map((e,t)=>{let i=h(e)||"";return(0,r.jsxs)("g",{children:[(0,r.jsx)("path",{fill:n,d:i,opacity:.05,stroke:"none",strokeWidth:0}),(0,r.jsx)("path",{fill:"none",d:i,opacity:l(t),stroke:n,strokeWidth:1})]},t)})}),null==R?void 0:R.getPrototypeSupportEmbeddings.map((e,t)=>{let n=A.labels[t];return(0,r.jsx)("g",{children:e.trainingExamples.map((t,l)=>{var i;let s=(null===(i=t.labels.find(t=>t.label===e.label))||void 0===i?void 0:i.confidence)||1,a=n.trainingExamples[l],o=L(m(a)),d=W(g(a)),u=(0,r.jsx)(j,{getSupportExampleImageSrc:c,getSupportExampleTabularData:p,inputDataType:b,label:e.label,sample:t});return(0,r.jsx)("circle",{className:"point ".concat(x()["training-example-point"]),cx:o,cy:d,fill:X(e.label),onClick:()=>er(o,d,u),onMouseEnter:()=>en(o,d,u),opacity:k?s/2+.5:1,stroke:"white",strokeWidth:"2"},l)})},t)}),null==R?void 0:R.getPrototypeSupportEmbeddings.map((e,t)=>{let n=A.labels[t].prototype,l=L(m(n)),i=W(g(n)),s=(0,r.jsx)(v,{label:e.label});return(0,r.jsx)("g",{children:(0,r.jsx)("circle",{className:"point ".concat(x()["prototype-point"]),cx:l,cy:i,fill:"black",onClick:()=>er(l,i,s),onMouseEnter:()=>en(l,i,s),stroke:"white",strokeWidth:"2"})},t)}),(0,r.jsx)("g",{children:_&&k&&k.map((e,t)=>{let l,i;let s=_[t],a=A.samples[t],c=L(m(a)),p=W(g(a)),d=(0,r.jsx)(y,{getInferenceSampleImageSrc:n,getInferenceSampleTabularData:o,inputDataType:b,processedClassProbabilities:s,sample:e});return(0,r.jsx)("circle",{className:"point ".concat(x()["inference-sample-point"]),cx:c,cy:p,fill:X((l="",i=0,Object.keys(s).forEach(e=>{s[e]>i&&(l=e,i=s[e])}),l)),onClick:()=>er(c,p,d),onMouseEnter:()=>en(c,p,d),stroke:"black",strokeWidth:"2"},t)})})]}),ee&&(0,r.jsx)("div",{style:{position:"absolute",top:ee.y-2,left:ee.x+7,right:"-1rem",border:"2px dashed gray"}}),$&&(0,r.jsx)("div",{style:{position:"absolute",top:$.y-2,left:"-1rem",right:U-$.x+7,border:"2px dashed gray"}}),(0,r.jsx)("div",{style:{position:"absolute",top:0,right:0},children:(0,r.jsx)(a.Z,{placement:"left",tooltipContent:(0,r.jsxs)("div",{style:{textAlign:"left"},children:[(0,r.jsx)("p",{children:(0,r.jsx)("b",{children:"Dimensionality Reduction Metrics"})}),(0,r.jsxs)("div",{style:{width:"100%"},children:[(0,r.jsxs)("p",{style:{marginBottom:"0"},children:[(0,r.jsx)("b",{children:"Continuity:"})," ",(0,r.jsx)("span",{style:{float:"right"},children:E(t,5)})]}),(0,r.jsxs)("p",{style:{marginBottom:"0"},children:[(0,r.jsx)("b",{children:"Stress: \xa0"})," ",(0,r.jsx)("span",{style:{float:"right"},children:E(D,5)})]}),C&&(0,r.jsxs)("p",{style:{marginBottom:"0"},children:[(0,r.jsx)("b",{children:"Scree Values:"}),"\xa0",(0,r.jsxs)("span",{style:{float:"right"},children:["[",C.map(e=>e.toFixed(2)).join(", "),"]"]})]}),(0,r.jsxs)("p",{style:{marginBottom:"0"},children:[(0,r.jsx)("b",{children:"Spearman's Rank:"})," ",(0,r.jsx)("span",{style:{float:"right"},children:E(M,5)})]}),(0,r.jsxs)("p",{style:{marginBottom:"0"},children:[(0,r.jsx)("b",{children:"Trustworthiness:"})," ",(0,r.jsx)("span",{style:{float:"right"},children:E(F,5)})]})]})]})})})]})}),(0,r.jsx)("div",{className:x()["uq-viz-sidebar"],style:{marginLeft:"1rem"},children:ee&&ee.msg})]})}let j=e=>{let{getSupportExampleImageSrc:t,getSupportExampleTabularData:n,inputDataType:l,label:i,sample:s}=e,a=[...s.labels].sort((e,t)=>Math.sign(t.confidence-e.confidence));return(0,r.jsxs)("div",{children:[(0,r.jsx)(c,{dataIndex:s.inputData.dataIndex,getSupportExampleImageSrc:t,getSupportExampleTabularData:n,inputDataType:l}),(0,r.jsxs)("div",{style:{padding:"0.5em"},children:[(0,r.jsxs)("p",{children:["This is an example from training with a true label of ",(0,r.jsx)(S,{label:i})]}),(0,r.jsx)("p",{children:(0,r.jsx)("b",{children:"Class Confidence Scores"})}),(0,r.jsx)("div",{style:{height:"3rem",overflowY:"auto"},children:(0,r.jsx)("table",{children:(0,r.jsx)("tbody",{children:a.map(e=>{let{label:t,confidence:n}=e;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{style:{textAlign:"left"},children:(0,r.jsxs)("b",{children:[t,":"]})}),(0,r.jsx)("td",{style:{textAlign:"right"},children:E(n)})]},t)})})})}),(0,r.jsx)("hr",{}),(0,r.jsxs)("p",{children:[(0,r.jsx)("b",{children:"Outlier Score:"})," ",s.ood.toFixed(2)]})]})]})},y=e=>{let{getInferenceSampleImageSrc:t,getInferenceSampleTabularData:n,inputDataType:l,processedClassProbabilities:i,sample:s}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)(c,{dataIndex:s.inputData.dataIndex,getInferenceSampleImageSrc:t,getInferenceSampleTabularData:n,inputDataType:l}),(0,r.jsxs)("div",{style:{padding:"0.5em"},children:[(0,r.jsx)("div",{children:Object.entries(i).filter(e=>{let[t,n]=e;return 1===n}).map(e=>{let[t,n]=e;return(0,r.jsxs)("p",{children:["This is an inference sample with prediction ",(0,r.jsx)(S,{label:t})]},t)})}),(0,r.jsx)("p",{children:(0,r.jsx)("b",{children:"Class Confidence Scores"})}),(0,r.jsx)("div",{style:{height:"3rem",overflowY:"auto"},children:(0,r.jsx)("table",{children:(0,r.jsx)("tbody",{children:Object.entries(s.classProbabilities).sort((e,t)=>{let[n,r]=e,[l,i]=t;return Math.sign(i-r)}).map(e=>{let[t,n]=e;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{style:{textAlign:"left"},children:(0,r.jsxs)("b",{children:[t,":"]})}),(0,r.jsx)("td",{style:{textAlign:"right"},children:E(n)})]},t)})})})}),(0,r.jsx)("hr",{}),(0,r.jsxs)("p",{children:[(0,r.jsx)("b",{children:"Outlier Score:"})," ",s.ood.toFixed(2)]})]})]})};function v(e){let{label:t}=e;return(0,r.jsxs)("div",{style:{padding:"0.5em"},children:[(0,r.jsxs)("p",{children:["This is the prototype for the label ",(0,r.jsx)(S,{label:t}),"."]}),(0,r.jsx)("p",{children:"There is no input associated with the prototype."})]})}let S=e=>{let t=e.label,n=(0,s.Z)();return(0,r.jsxs)("b",{style:{whiteSpace:"nowrap"},children:[t," ",(0,r.jsx)("span",{className:"circle",style:{backgroundColor:n(t)}})]})};function I(e,t,n,r){let l=arguments.length>4&&void 0!==arguments[4]&&arguments[4];e[0]=l?n:Math.min(e[0],n),e[1]=l?n:Math.max(e[1],n),t[0]=l?r:Math.min(t[0],r),t[1]=l?r:Math.max(t[1],r)}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=e.toFixed(t);return"0.00"===n?e.toExponential(1):n}function w(e){let{getInferenceSampleImageSrc:t,getInferenceSampleTabularData:n,inputDataType:l,processedClassesProbabilities:i,sampleIndex:s,samples:a,scaleX:o,scaleY:c,structuredEmbeddings:p}=e,d=p.samples[s],u=o(m(d)),x=c(g(d)),h=i[s];return{x:u,y:x,msg:(0,r.jsx)(y,{getInferenceSampleImageSrc:t,getInferenceSampleTabularData:n,inputDataType:l,processedClassProbabilities:h,sample:a[s]})}}function T(e){let{getSupportExampleImageSrc:t,getSupportExampleTabularData:n,inputDataType:l,labelIdx:i,pointIdx:s,scaleX:a,scaleY:o,structuredEmbeddings:c,prototypeSupportEmbeddings:p}=e,d=c.labels[i].trainingExamples[s],u=a(m(d)),x=o(g(d)),h=p.getPrototypeSupportEmbeddings[i];return{x:u,y:x,msg:(0,r.jsx)(j,{getSupportExampleImageSrc:t,getSupportExampleTabularData:n,inputDataType:l,label:h.label,sample:h.trainingExamples[s]})}}},6299:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(5567),l=n(8697),i=n(8468);let s=(0,l.P1)(e=>e.uiSettings,e=>{let{colorBlindMode:t,oodColorMode:n}=e;return t?(0,i.rg)(i.bU,n,i.$_):(0,i.rg)(i.O9,n,i.Q$)});function a(){return(0,r.C)(s)}},5316:function(e,t,n){"use strict";n.d(t,{y:function(){return r}});let r={plugins:{legend:{labels:{color:"white"},title:{color:"white"}}},scales:{x:{grid:{borderColor:"#777",color:"#777"},ticks:{color:"white"}},y:{grid:{borderColor:"#777",color:"#777"},ticks:{color:"white"}}}}},7765:function(e,t,n){"use strict";function r(e){document.title="EQUI(NE)\xb2 - ".concat(e)}n.d(t,{Z:function(){return r}})},485:function(e){e.exports={infoTooltip:"InfoTooltip_infoTooltip__XHOEb"}},3275:function(e){e.exports={"uq-viz-container":"ScatterUQ_uq-viz-container__Nsp3M",circle:"ScatterUQ_circle__GDFw0",arrow:"ScatterUQ_arrow__oXuJU","uq-viz-sidebar":"ScatterUQ_uq-viz-sidebar__PeHXh","prototype-point":"ScatterUQ_prototype-point__M1lyY","training-example-point":"ScatterUQ_training-example-point__NGItq","inference-sample-point":"ScatterUQ_inference-sample-point__OEZLO"}}}]);