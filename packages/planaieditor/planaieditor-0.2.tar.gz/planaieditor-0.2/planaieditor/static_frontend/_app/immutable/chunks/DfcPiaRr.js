import{y as d,z as l,c as A,A as I,B,k as v,G as P,H as T}from"./DRtkoAoK.js";var C;(function(r){r[r.None=0]="None",r[r.Indent=1]="Indent",r[r.IndentOutdent=2]="IndentOutdent",r[r.Outdent=3]="Outdent"})(C||(C={}));class b{constructor(e){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,s=e.notIn.length;t<s;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case d.Other:return!0;case d.Comment:return this._inComment;case d.String:return this._inString;case d.RegEx:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;const s=e.findTokenIndexAtOffset(t-2),n=e.getStandardTokenType(s);return this.isOK(n)}_findNeutralCharacterInRange(e,t){for(let s=e;s<=t;s++){const n=String.fromCharCode(s);if(!this.open.includes(n)&&!this.close.includes(n))return n}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(l.Digit0,l.Digit9)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(l.a,l.z)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(l.A,l.Z))),this._neutralCharacter}}class x{constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const t of e)f(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),f(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),f(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),f(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&f(this.autoClosingPairsCloseSingleChar,t.close,t)}}function f(r,e,t){r.has(e)?r.get(e).push(t):r.set(e,[t])}const M=A("ILanguageStatusService");function y(r,e,t,s,n,a){if(Array.isArray(r)){let o=0;for(const i of r){const u=y(i,e,t,s,n,a);if(u===10)return u;u>o&&(o=u)}return o}else{if(typeof r=="string")return s?r==="*"?5:r===t?10:0:0;if(r){const{language:o,pattern:i,scheme:u,hasAccessToAllModels:k,notebookType:_}=r;if(!s&&!k)return 0;_&&n&&(e=n);let h=0;if(u)if(u===e.scheme)h=10;else if(u==="*")h=5;else return 0;if(o)if(o===t)h=10;else if(o==="*")h=Math.max(h,5);else return 0;if(_)if(_===a)h=10;else if(_==="*"&&a!==void 0)h=Math.max(h,5);else return 0;if(i){let g;if(typeof i=="string"?g=i:g={...i,base:I(i.base)},g===e.fsPath||B(g,e.fsPath))h=10;else return 0}return h}else return 0}}function E(r){return typeof r=="string"?!1:Array.isArray(r)?r.some(E):!!r.notebookType}function S(r){return typeof r=="string"?!1:Array.isArray(r)?r.every(S):!!r.exclusive}class p{constructor(e,t,s,n,a){this.uri=e,this.languageId=t,this.notebookUri=s,this.notebookType=n,this.recursive=a}equals(e){var t,s;return this.notebookType===e.notebookType&&this.languageId===e.languageId&&this.uri.toString()===e.uri.toString()&&((t=this.notebookUri)==null?void 0:t.toString())===((s=e.notebookUri)==null?void 0:s.toString())&&this.recursive===e.recursive}}class m{constructor(e){this._notebookInfoResolver=e,this._clock=0,this._entries=[],this._onDidChange=new v,this.onDidChange=this._onDidChange.event}register(e,t){let s={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(s),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),P(()=>{if(s){const n=this._entries.indexOf(s);n>=0&&(this._entries.splice(n,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),s=void 0)}})}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e,!1);const t=[];for(const s of this._entries)s._score>0&&t.push(s.provider);return t}allNoModel(){return this._entries.map(e=>e.provider)}ordered(e,t=!1){const s=[];return this._orderedForEach(e,t,n=>s.push(n.provider)),s}orderedGroups(e){const t=[];let s,n;return this._orderedForEach(e,!1,a=>{s&&n===a._score?s.push(a.provider):(n=a._score,s=[a.provider],t.push(s))}),t}_orderedForEach(e,t,s){this._updateScores(e,t);for(const n of this._entries)n._score>0&&s(n)}_updateScores(e,t){var a,o;const s=(a=this._notebookInfoResolver)==null?void 0:a.call(this,e.uri),n=s?new p(e.uri,e.getLanguageId(),s.uri,s.type,t):new p(e.uri,e.getLanguageId(),void 0,void 0,t);if(!((o=this._lastCandidate)!=null&&o.equals(n))){this._lastCandidate=n;for(const i of this._entries)if(i._score=y(i.selector,n.uri,n.languageId,T(e),n.notebookUri,n.notebookType),S(i.selector)&&i._score>0)if(t)i._score=0;else{for(const u of this._entries)u._score=0;i._score=1e3;break}this._entries.sort(m._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:c(e.selector)&&!c(t.selector)?1:!c(e.selector)&&c(t.selector)?-1:e._time<t._time?1:e._time>t._time?-1:0}}function c(r){return typeof r=="string"?!1:Array.isArray(r)?r.some(c):!!r.isBuiltin}export{x as A,C as I,m as L,b as S,M as a,y as s,E as t};
//# sourceMappingURL=DfcPiaRr.js.map
