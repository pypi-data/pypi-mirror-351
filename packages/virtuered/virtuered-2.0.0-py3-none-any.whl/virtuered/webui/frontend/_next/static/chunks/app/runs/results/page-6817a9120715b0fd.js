(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[128],{16505:e=>{e.exports={ranking:"VulnerabilityRanking_ranking__6LA_U"}},37123:(e,a,s)=>{"use strict";s.d(a,{Q:()=>n});let t=()=>window.__NEXT_PUBLIC_API_URL__||"https://api.yourproduction.com",n=new Proxy({runs:{refresh:"/datasets/refresh",testchat:"/scan/testchat",list:"/scan/list",progress:"/scan/progress",action:"/api/runs/action",filterRuns:"/scan/list",image:e=>"/scan/images/".concat(e),start:"/scan/start",pause:e=>"/scan/pause/".concat(e),resume:e=>"/scan/resume/".concat(e),delete:e=>"/scan/delete/".concat(e),info:e=>"/scan/info/".concat(e),compare:e=>"/scan/compare_scans/".concat(e),getById:e=>"/api/runs/".concat(e),merge:"/scan/merge",mergeEligible:"/scan/eligible_for_merge"},datasets:{list:"/datasets/list",refresh:"/datasets/refresh"},model:{list:"/scan/models",listAll:"/scan/filter_models",scans:e=>"/scan/list?filter_model=".concat(e),chartData:e=>"/scan/line_charts/".concat(e)},analytics:e=>"/api/analytics/".concat(e),vulnerabilities:{list:"/scan/summary/"},results:e=>"/scan/summary/".concat(e),downloadFailures:e=>"/scan/download_failures/".concat(e),generatePdf:e=>"/scan/generate_pdf/".concat(e),clientAddress:"/getclientaddress",dashboard:{stats:"/dashboard/stats",activities:"/dashboard/activities"},images:{serve:e=>"/api/images/".concat(e)}},{get(e,a){let s=t(),n=e[a];return"object"==typeof n?new Proxy(n,{get(e,a){let t=e[a];return"function"==typeof t?function(){for(var e=arguments.length,a=Array(e),n=0;n<e;n++)a[n]=arguments[n];return"".concat(s).concat(t(...a))}:"".concat(s).concat(t)}}):"function"==typeof n?function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return"".concat(s).concat(n(...a))}:"".concat(s).concat(n)}})},42874:e=>{e.exports={datasets:"DatasetTags_datasets__ycMje",tags:"DatasetTags_tags__EMtjf",singleLineTags:"DatasetTags_singleLineTags__T0gkJ",tag:"DatasetTags_tag__bA61h"}},45063:e=>{e.exports={spinner:"Spinner_spinner__lWskE",spinnerRing:"Spinner_spinnerRing__FAG9d",spin:"Spinner_spin__y94gD"}},47944:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>$});var t=s(95155),n=s(12115),r=s(35695),i=s(37123),l=s(53625),c=s.n(l),o=s(54091),d=s.n(o);function u(e){let{scanName:a,scanId:s}=e,[r,l]=(0,n.useState)(!1),[c,o]=(0,n.useState)(!1),u=(e,a)=>{var s,t;return(null==e||null==(t=e.split("filename=")[1])||null==(s=t.replace(/["']/g,""))?void 0:s.trim())||a},m=async()=>{if(!r){l(!0);try{let e=await fetch(i.Q.downloadFailures(s));if(!e.ok)throw Error("Download failed");let a=u(e.headers.get("Content-Disposition"),"failures.zip"),t=await e.blob(),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=a,document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(n)}catch(e){console.error("Failed to download failure cases:",e)}finally{l(!1)}}},_=async()=>{if(!c){o(!0);try{let e=await fetch(i.Q.generatePdf(s));if(!e.ok)throw Error("Download failed");let a=u(e.headers.get("Content-Disposition"),"report.pdf"),t=await e.blob(),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=a,document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(n)}catch(e){console.error("Failed to download report:",e)}finally{o(!1)}}};return(0,t.jsxs)("div",{className:d().header,children:[(0,t.jsx)("div",{className:d().info,children:(0,t.jsxs)("h2",{className:d().resultsTitle,children:["Results: ",a]})}),(0,t.jsxs)("div",{className:d().actions,children:[(0,t.jsx)("button",{className:"".concat(d().downloadButton," ").concat(r?d().loading:""),onClick:m,disabled:r,children:r?(0,t.jsxs)("span",{className:d().spinnerContainer,children:[(0,t.jsx)("svg",{className:d().spinningIcon,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})}),"Downloading..."]}):(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:d().downloadButtonIconWarning,children:"⚠️"}),(0,t.jsx)("span",{children:"Download Failure Cases"})]})}),(0,t.jsx)("button",{className:"".concat(d().downloadButton," ").concat(c?d().loading:""),onClick:_,disabled:c,children:c?(0,t.jsxs)("span",{className:d().spinnerContainer,children:[(0,t.jsx)("svg",{className:d().spinningIcon,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})}),"Downloading..."]}):"\uD83D\uDCC4 Download Report"})]})]})}var m=s(88175),_=s.n(m);function h(e){let{progress:a,createTime:s,scanName:n,modelName:r,totalSamples:i}=e;return(0,t.jsxs)("div",{className:_().overview,children:[(0,t.jsxs)("div",{className:_().progress,children:[(0,t.jsx)("h2",{children:"Scanning Progress"}),(0,t.jsxs)("div",{className:_().progressValue,children:[a,"%"]})]}),(0,t.jsxs)("div",{className:_().details,children:[(0,t.jsxs)("div",{className:_().detailItem,children:[(0,t.jsx)("label",{children:"Create Time"}),(0,t.jsx)("span",{children:s})]}),(0,t.jsxs)("div",{className:_().detailItem,children:[(0,t.jsx)("label",{children:"Scan Name"}),(0,t.jsx)("span",{children:n})]}),(0,t.jsxs)("div",{className:_().detailItem,children:[(0,t.jsx)("label",{children:"Model Name"}),(0,t.jsx)("span",{children:r})]}),(0,t.jsxs)("div",{className:_().detailItem,children:[(0,t.jsx)("label",{children:"Total Scanned Samples"}),(0,t.jsx)("span",{children:i})]})]})]})}var p=s(42874),g=s.n(p);function x(e){let{datasets:a}=e,s=a.length<5;return(0,t.jsxs)("div",{className:g().datasets,children:[(0,t.jsx)("h3",{children:"Selected Tests"}),(0,t.jsx)("div",{className:"".concat(g().tags," ").concat(s?g().singleLineTags:""),children:a.map(e=>(0,t.jsx)("div",{className:g().tag,children:e},e))})]})}var v=s(83540),j=s(3401),f=s(94754),b=s(96025),y=s(16238),N=s(94517),k=s(83394),C=s(54811),w=s(70098),R=s(68238),S=s(11832),I=s(57313),O=s(89190),F=s(70611),T=s.n(F);let V="rgb(255, 99, 132)",E="rgb(255, 206, 86)",L="rgb(54, 162, 235)",A="rgb(75, 192, 192)",B=(e,a,s)=>{let t=e.match(/\d+/g).map(Number),n=a.match(/\d+/g).map(Number),r=Math.round(t[0]+(n[0]-t[0])*s),i=Math.round(t[1]+(n[1]-t[1])*s),l=Math.round(t[2]+(n[2]-t[2])*s);return"rgb(".concat(r,",").concat(i,",").concat(l,")")},D=e=>e<=50?B(V,E,e/50):B(E,A,(e-50)/50);function z(e){let{scores:a,comparisonScores:s={},scanName:r,comparisonNames:i={},comparisonScans:l,onComparisonSelect:c,selectedComparisonIds:o=[],hideComparisonSelect:d=!1,tickFontSize:u=11,useScoreColors:m=!1,className:_,barChartClassName:h,radarChartOuterRadius:p="90%",radarChartCy:g}=e,[x,F]=(0,n.useState)(!1),[V,E]=(0,n.useState)(400),L=(0,n.useRef)(null),A=(0,n.useRef)(null),B=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=()=>{L.current&&E(L.current.clientHeight)};e();let a=new ResizeObserver(a=>{e()});return L.current&&a.observe(L.current),()=>{a.disconnect()}},[]),(0,n.useEffect)(()=>{let e=e=>{var a;null!=(a=B.current)&&a.contains(e.target)||A.current&&!A.current.contains(e.target)&&F(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let z=["#60A5FA","#34D399","#F472B6","#FBBF24","#A78BFA"],H=Object.entries(a).map(e=>{let[t,n]=e,r={subject:t,value:n,fullMark:100};return Object.entries(a).length>2?(g="50%",p="90%"):(g="50%",p="80%"),Object.keys(s).forEach((e,a)=>{var n;r["comparisonValue".concat(a)]=(null==(n=s[e])?void 0:n[t])||0}),r}),M=Object.entries(a).map(e=>{let[a,t]=e,n={name:a,value:t};return Object.keys(s).forEach((e,t)=>{var r;n["comparisonValue".concat(t)]=(null==(r=s[e])?void 0:r[a])||0}),n}),P=e=>{let a=e.split(" "),s=[],t="";return a.forEach(e=>{(t+" "+e).length<=15?t=t?"".concat(t," ").concat(e):e:(t&&s.push(t),t=e)}),t&&s.push(t),s},U=Object.keys(a).length<3;return(0,t.jsxs)("div",{className:T().radarChart,children:[(0,t.jsx)("div",{className:T().header,children:!d&&(0,t.jsxs)("div",{className:T().comparisonSection,children:[(0,t.jsx)("button",{ref:B,className:T().comparisonButton,onClick:()=>F(!x),title:"Models are comparable when they share some of the same tests as the current scan",children:"Select Comparison Models"}),x&&(0,t.jsx)("div",{ref:A,className:T().dropdownMenu,children:l.length>0?l.map(e=>{let a=o.includes(e.scan_id);return(0,t.jsx)("div",{className:"".concat(T().dropdownItem," ").concat(a?T().selected:""),onClick:()=>{c(e,!a)},children:(0,t.jsxs)("div",{className:T().scanInfo,children:[(0,t.jsxs)("div",{className:T().scanName,children:[a&&(0,t.jsx)("span",{className:T().checkmark,children:"✓"}),"Scan: ",e.scan_name]}),(0,t.jsxs)("div",{className:T().modelInfo,children:[e.model_name," • ",e.scan_time]})]})},e.scan_id)}):(0,t.jsx)("div",{className:T().dropdownItem,children:(0,t.jsx)("div",{className:T().scanInfo,children:(0,t.jsx)("div",{className:T().scanName,children:"No comparable models available"})})})})]})}),(0,t.jsxs)("div",{className:T().chartKey,children:[(0,t.jsxs)("div",{className:T().legendItem,children:[(0,t.jsx)("div",{className:T().keyIcon,style:m&&U?{background:D(Object.values(a)[0]||0),border:"1px solid",borderColor:D(Object.values(a)[0]||0),opacity:.5}:void 0}),(0,t.jsx)("span",{children:r})]}),Object.keys(s).map((e,a)=>(0,t.jsxs)("div",{className:T().legendItem,children:[(0,t.jsx)("div",{className:"".concat(T().keyIcon," ").concat(T().comparison),style:m&&U?{background:D(Object.values(s[e])[0]||0),border:"1px solid",borderColor:D(Object.values(s[e])[0]||0),opacity:.5}:{background:z[a%z.length]}}),(0,t.jsx)("span",{children:i[e]||"Comparison ".concat(a+1)})]},e))]}),(0,t.jsx)("div",{ref:L,className:"".concat(T().chartContainer," ").concat(_||""),children:(0,t.jsx)(v.u,{width:"100%",height:"100%",children:U?(0,t.jsx)("div",{className:"".concat(T().barChartContainer," ").concat(h||""),children:(0,t.jsx)(v.u,{width:d?"94%":"92%",height:"50%",children:(0,t.jsxs)(j.E,{data:M,layout:"vertical",margin:d?{top:80,right:20,left:75,bottom:20}:{top:60,right:20,left:20,bottom:40},children:[(0,t.jsx)(f.d,{stroke:"#374151",strokeDasharray:"1 1",horizontal:!0,vertical:!0}),(0,t.jsx)(b.W,{type:"number",axisLine:{stroke:"#374151"},tickLine:{stroke:"#374151"},domain:[0,100],label:{value:"Risk Score",position:"bottom",fill:"var(--main-text)",offset:0}}),(0,t.jsx)(y.h,{type:"category",dataKey:"name",axisLine:{stroke:"#374151"},tickLine:{stroke:"#374151"},tick:{fill:"var(--main-text)",fontSize:"0.9rem",width:"100"}}),(0,t.jsx)(N.m,{contentStyle:{backgroundColor:"var(--tile-bg2)",border:"1px solid var(--tile-border)",borderRadius:"var(--radius-small)",color:"var(--main-text)"},formatter:e=>["Risk Score: ".concat(e),""],cursor:!1,separator:""}),(0,t.jsx)(k.y,{dataKey:"value",fill:m?D(M[0].value):"#9333EA",stroke:m?D(M[0].value):"#9333EA",fillOpacity:.3,name:r,children:m&&M.map((e,a)=>(0,t.jsx)(C.f,{fill:D(e.value)},"cell-".concat(a)))}),Object.keys(s).map((e,a)=>(0,t.jsx)(k.y,{dataKey:"comparisonValue".concat(a),fill:m?D(Object.values(s[e])[0]||0):z[a%z.length],stroke:m?D(Object.values(s[e])[0]||0):z[a%z.length],fillOpacity:.3,name:i[e]||"Comparison ".concat(a+1),children:m&&M.map((e,s)=>(0,t.jsx)(C.f,{fill:D(e["comparisonValue".concat(a)])},"cell-comparison-".concat(s)))},e))]})})}):(0,t.jsxs)(w.V,{outerRadius:d?"65%":p,data:H,margin:d?{top:60,right:60,bottom:20,left:70}:{top:40,right:60,bottom:30,left:70},cy:d?"35%":g,children:[(0,t.jsx)(R.z,{stroke:"#374151"}),(0,t.jsx)(S.r,{dataKey:"subject",tick:e=>{let{payload:a,x:s,y:n,textAnchor:r}=e,{value:i}=a,l=P(i),c=1.2*u,o=V/2,d=s,m=n,_=(l.length-1)*c;return"end"===r?d-=2:"start"===r?d+=2:"middle"===r&&(n<o?m-=8:m+=8),n<o?m-=2:m+=2,(0,t.jsx)("g",{children:l.map((e,a)=>(0,t.jsx)("text",{x:d,y:m+a*c-_/2,textAnchor:r,fill:"#FFFFFF",fontSize:u,children:e},a))})},tickLine:!1}),(0,t.jsx)(I.E,{angle:90,domain:[0,100],tickCount:6,tick:{fill:"#FFFFFF",dy:15,textAnchor:"middle",fontSize:u,width:"100"}}),(0,t.jsx)(O.V,{name:r,dataKey:"value",stroke:"#9333EA",fill:"#9333EA",fillOpacity:.4}),Object.keys(s).map((e,a)=>(0,t.jsx)(O.V,{name:i[e]||"Comparison ".concat(a+1),dataKey:"comparisonValue".concat(a),stroke:z[a%z.length],fill:z[a%z.length],fillOpacity:.4},e))]})})})]})}var H=s(16505),M=s.n(H);function P(e){let{rankings:a}=e,s=a.total,n=e=>Number((100*e/s).toFixed(1)),r=[{name:"High Risk",value:n(a.high),fill:V,stroke:V},{name:"Low Risk",value:n(a.low),fill:E,stroke:E},{name:"No Response",value:n(a.noResponse),fill:L,stroke:L},{name:"No Risk",value:n(a.none),fill:A,stroke:A}];return(0,t.jsxs)("div",{className:M().container,children:[(0,t.jsx)("h2",{className:M().subSectionTitle,children:"Vulnerability Ranking"}),(0,t.jsx)(v.u,{width:"95%",height:300,children:(0,t.jsxs)(j.E,{data:r,layout:"vertical",margin:{top:20,right:30,left:80,bottom:40},children:[(0,t.jsx)(f.d,{stroke:"#374151",strokeDasharray:"0 0",horizontal:!0,vertical:!0}),(0,t.jsx)(b.W,{type:"number",tickCount:10,axisLine:{stroke:"#374151"},tickLine:{stroke:"#374151"},tick:{fill:"#9CA3AF"},label:{value:"Percentages",position:"bottom",fill:"var(--main-text)",offset:0}}),(0,t.jsx)(y.h,{type:"category",dataKey:"name",tick:{fill:"var(--main-text)",width:100,fontSize:"0.9rem"},axisLine:{stroke:"#374151"},tickLine:{stroke:"#374151"}}),(0,t.jsx)(N.m,{content:(0,t.jsx)(e=>{let{active:a,payload:s}=e;if(a&&s&&s.length){let e=s[0].payload.fill,a=s[0].payload.name,n=s[0].payload.value;return(0,t.jsxs)("div",{style:{backgroundColor:"var(--bg2)",border:"1px solid var(--tile-border)",borderRadius:"var(--radius-small)",color:"var(--main-text)",padding:"8px"},children:[(0,t.jsx)("p",{style:{color:e,fontWeight:700},children:a}),(0,t.jsxs)("p",{children:["Total Risk Count: ",n,"%"]})]})}return null},{}),cursor:!1}),(0,t.jsx)(k.y,{dataKey:"value",fillOpacity:.3})]})})]})}var U=s(99590),Q=s.n(U),W=s(66766),K=s(90792);function G(e){let{categories:a}=e,[s,r]=(0,n.useState)([]);return(0,t.jsxs)("div",{className:Q().categories,children:[(0,t.jsx)("h2",{children:"Risk by Category"}),Object.entries(a).map(e=>{let[a,n]=e;return(0,t.jsxs)("div",{className:Q().category,children:[(0,t.jsxs)("button",{className:Q().categoryHeader,onClick:()=>{r(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a])},children:[(0,t.jsxs)("div",{className:Q().categoryTitle,children:[(0,t.jsx)("span",{children:a}),(0,t.jsx)("span",{className:Q().score,style:{color:D(n.score)},children:n.score.toFixed(2)})]}),(0,t.jsx)("span",{className:Q().arrow,children:s.includes(a)?"▼":"▶"})]}),s.includes(a)&&(0,t.jsxs)("div",{className:Q().categoryDetails,children:[(0,t.jsx)("div",{className:Q().subcategoryChart,children:(0,t.jsx)(z,{scores:n.subcategories||{},scanName:a,comparisonScans:[],onComparisonSelect:()=>{},hideComparisonSelect:!0,tickFontSize:10,useScoreColors:!0,className:Q().riskCategoryRadarChart,barChartClassName:Q().riskCategoryBarChartContainer})}),n.details&&n.details.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{children:"Top Failures"}),(0,t.jsx)("div",{className:Q().failures,children:n.details.map((e,a)=>(0,t.jsx)("div",{className:Q().failure,children:(0,t.jsxs)("div",{className:Q().failureCard,children:[(0,t.jsx)("div",{className:Q().failureHeader,children:(0,t.jsx)("span",{className:Q().subcategory,children:e.subcategory})}),e.prompt.map((a,s)=>(0,t.jsxs)("div",{className:Q().input,children:[(0,t.jsx)("h4",{children:"Prompt Input:"}),Array.isArray(a.content)?a.content.map((a,s)=>(0,t.jsxs)("div",{className:Q().failureContent,children:[a.text&&(0,t.jsx)("div",{className:Q().contentText,children:(0,t.jsx)(K.oz,{children:a.text})}),"image_url"===a.type&&a.image_url&&(0,t.jsxs)("div",{className:Q().mediaContainer,children:[(0,t.jsx)("div",{className:Q().imageContainer,children:(0,t.jsx)(W.default,{src:i.Q.runs.image(a.image_url.url),alt:"Content visualization",className:Q().contentImage,width:e.input_modalities&&e.input_modalities.includes("video")?700:500,height:e.input_modalities&&e.input_modalities.includes("video")?500:350,unoptimized:!0})}),e.input_modalities&&e.input_modalities.includes("video")&&(0,t.jsx)("div",{className:Q().videoNoteContainer,style:{textAlign:"center",marginTop:"8px"},children:(0,t.jsxs)("div",{className:Q().videoNote,title:"This content shows 3 frames extracted from a video",children:[(0,t.jsx)("span",{className:Q().videoIcon,style:{marginRight:"8px"},children:"\uD83C\uDFAC"}),"Video Input Snapshot (3 frames)"]})})]})]},s)):(0,t.jsx)("div",{className:Q().failureContent,children:"string"==typeof a.content?(0,t.jsx)("div",{className:Q().contentText,children:(0,t.jsx)(K.oz,{children:a.content})}):a.content.text?(0,t.jsx)("div",{className:Q().contentText,children:(0,t.jsx)(K.oz,{children:a.content.text})}):null})]},s)),(0,t.jsxs)("div",{className:Q().answer,children:[(0,t.jsx)("h4",{children:"Answer:"}),(0,t.jsx)("div",{className:Q().answerText,children:e.output_modalities&&(e.output_modalities.includes("image")||e.output_modalities.includes("video"))?(0,t.jsxs)("div",{className:Q().mediaContainer,children:[(0,t.jsx)("div",{className:Q().imageContainer,children:(0,t.jsx)(W.default,{src:i.Q.runs.image(e.answer),alt:"Answer visualization",className:Q().contentImage,width:e.output_modalities&&e.output_modalities.includes("video")?700:500,height:e.output_modalities&&e.output_modalities.includes("video")?500:350,unoptimized:!0})}),e.output_modalities&&e.output_modalities.includes("video")&&(0,t.jsx)("div",{className:Q().videoNoteContainer,style:{textAlign:"center",marginTop:"8px"},children:(0,t.jsxs)("div",{className:Q().videoNote,title:"This content shows 3 frames extracted from a video",style:{display:"inline-flex"},children:[(0,t.jsx)("span",{className:Q().videoIcon,style:{marginRight:"8px"},children:"\uD83C\uDFAC"})," Video Output Snapshot (3 frames)"]})})]}):(0,t.jsx)(K.oz,{children:e.answer})})]})]})},a))})]}):(0,t.jsx)("div",{className:Q().noFailures,children:(0,t.jsx)("h3",{children:"No Failures Found"})})]})]},a)})]})}var Y=s(48263),q=s(6874),J=s.n(q);function X(e){let{items:a}=e;return(0,t.jsx)("nav",{className:"flex mb-2","aria-label":"Breadcrumb",children:(0,t.jsx)("ol",{className:"flex items-center bg-[var(--bg2)] py-2 px-4 rounded",children:a.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-center",children:[s>0&&(0,t.jsx)("span",{className:"mx-2 text-gray-400",children:">"}),s===a.length-1?(0,t.jsx)("span",{className:"text-purple-400 font-medium",children:e.label}):(0,t.jsx)(J(),{href:e.href,className:"text-gray-300 hover:text-white transition-colors",children:e.label})]},e.href))})})}function Z(){let e=(0,r.useSearchParams)().get("id"),[a,s]=(0,n.useState)(null),[l,o]=(0,n.useState)(null),[d,m]=(0,n.useState)(!0),[_,p]=(0,n.useState)(null),[g,v]=(0,n.useState)([]),[j,f]=(0,n.useState)({}),b=(0,n.useRef)(!1),y=(0,n.useCallback)(async()=>{if(e&&!b.current)try{b.current=!0,m(!0);let a={cache:"no-store",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}},t=await Promise.all([fetch(i.Q.runs.info(e),a),fetch(i.Q.results(e),a),fetch(i.Q.runs.compare(e),a)]);t.forEach((e,a)=>{if(!e.ok)throw Error("Failed to fetch ".concat(["scan info","results","comparison scans"][a],": ").concat(e.statusText))});let[n,r,l]=await Promise.all(t.map(e=>e.json()));s(n),o(r),v(l),p(null)}catch(e){console.error("Error loading scan data:",e),p(e instanceof Error?e.message:"Failed to load scan data"),s(null),o(null),v([])}finally{m(!1),b.current=!1}},[e]);(0,n.useEffect)(()=>{y()},[y]);let N=async(e,a)=>{if(a)try{let a=await fetch(i.Q.results(e.scan_id));if(!a.ok)throw Error("Failed to fetch comparison results");let s=await a.json();f(a=>({...a,[e.scan_id]:s}))}catch(e){console.error("Failed to load comparison results:",e)}else f(a=>{let s={...a};return delete s[e.scan_id],s})};if(d)return(0,t.jsx)("div",{className:c().loading,children:(0,t.jsx)(Y.y,{})});if(_)return(0,t.jsx)("div",{className:c().container,children:_});if(!a)return(0,t.jsx)("div",{className:c().container,children:"No scan info found"});if(!l)return(0,t.jsx)("div",{className:c().container,children:"No results found"});let k={scanning_progress:100,create_time:a.time,scan_name:a.scan_name,model_name:l.model_name,total_scanned_samples:l.total_length,selected_datasets:Object.keys(l.averages_sub||{}),vulnerability_scores:l.averages||{},vulnerability_ranking:{high:l.scores["High Risk"]||0,low:l.scores["Low Risk"]||0,none:l.scores["No Risk"]||0,noResponse:l.scores["No Response"]||0,total:l.total_length||0},risk_by_category:{...Object.entries(l.averages_sub||{}).reduce((e,a)=>{let[s,t]=a;return{...e,[s]:{score:l.averages[s]||0,details:l.failures[s]||[],subcategories:t}}},{})}};return(0,t.jsxs)("div",{className:c().container,children:[(0,t.jsx)(X,{items:[{label:"Runs",href:"/runs"},{label:"Results",href:"/runs/results/".concat(e||"")}]}),(0,t.jsx)(u,{scanName:a.scan_name,scanId:l.scan_id}),(0,t.jsxs)("div",{className:c().topSection,children:[(0,t.jsxs)("div",{className:c().leftColumn,children:[(0,t.jsx)(h,{progress:k.scanning_progress,createTime:k.create_time,scanName:k.scan_name,modelName:k.model_name,totalSamples:k.total_scanned_samples}),(0,t.jsx)(x,{datasets:k.selected_datasets})]}),(0,t.jsx)("div",{className:c().rightColumn,children:(0,t.jsx)(z,{scores:k.vulnerability_scores,comparisonScores:Object.entries(j).reduce((e,a)=>{let[s,t]=a;return{...e,[s]:t.averages}},{}),scanName:l.scan_id,comparisonNames:Object.entries(j).reduce((e,a)=>{let[s,t]=a;return{...e,[s]:t.scan_id}},{}),comparisonScans:g,onComparisonSelect:N,selectedComparisonIds:Object.keys(j),useScoreColors:!0})})]}),(0,t.jsx)(P,{rankings:k.vulnerability_ranking}),(0,t.jsx)(G,{categories:k.risk_by_category})]})}function $(){return(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:c().loading,children:(0,t.jsx)(Y.y,{})}),children:(0,t.jsx)(Z,{})})}},48263:(e,a,s)=>{"use strict";s.d(a,{y:()=>i});var t=s(95155);s(12115);var n=s(45063),r=s.n(n);let i=e=>{let{className:a}=e;return(0,t.jsx)("div",{className:"".concat(r().spinner," ").concat(a||""),children:(0,t.jsx)("div",{className:r().spinnerRing})})}},53625:e=>{e.exports={container:"results_container__cv6e_",topSection:"results_topSection__o6iIo",subSectionTitle:"results_subSectionTitle__iQMmE",leftColumn:"results_leftColumn__PlM2V",rightColumn:"results_rightColumn__5J959",comparisonSection:"results_comparisonSection__KNq2p",dropdownMenu:"results_dropdownMenu__iY7cs",dropdownItem:"results_dropdownItem__A4_EY",scanInfo:"results_scanInfo__IyLuu",scanName:"results_scanName__C0aTe",modelInfo:"results_modelInfo__nfEDj",charts:"results_charts__p3lAE"}},54091:e=>{e.exports={header:"ScanResultsHeader_header__Mt3BC",resultsTitle:"ScanResultsHeader_resultsTitle__CM71V",info:"ScanResultsHeader_info__B3z9l",details:"ScanResultsHeader_details__mABtn",actions:"ScanResultsHeader_actions__FgZVb",downloadButton:"ScanResultsHeader_downloadButton__mD16T",downloadButtonIconWarning:"ScanResultsHeader_downloadButtonIconWarning__od_f6",spinnerContainer:"ScanResultsHeader_spinnerContainer__Cn1SS",spinningIcon:"ScanResultsHeader_spinningIcon__KYD1r",spin:"ScanResultsHeader_spin__LfItx",breadcrumb:"ScanResultsHeader_breadcrumb__9VsaI",shareButton:"ScanResultsHeader_shareButton__8ENGq"}},70611:e=>{e.exports={radarChart:"VulnerabilityRadar_radarChart__GA__a",header:"VulnerabilityRadar_header__rYrPG",chartContainer:"VulnerabilityRadar_chartContainer__O2jPO",barChartContainer:"VulnerabilityRadar_barChartContainer__cLxUq",chartKey:"VulnerabilityRadar_chartKey__6DwMO",legendItem:"VulnerabilityRadar_legendItem__OWXvl",keyIcon:"VulnerabilityRadar_keyIcon__t9ZAg",comparison:"VulnerabilityRadar_comparison__g13My",comparisonSection:"VulnerabilityRadar_comparisonSection__cJqHg",comparisonButton:"VulnerabilityRadar_comparisonButton__WGPAg",dropdownMenu:"VulnerabilityRadar_dropdownMenu__pW35c",dropdownItem:"VulnerabilityRadar_dropdownItem__hIYWT",selected:"VulnerabilityRadar_selected__QlrSk",checkmark:"VulnerabilityRadar_checkmark__XXLkv",scanName:"VulnerabilityRadar_scanName__WtJLo",scanInfo:"VulnerabilityRadar_scanInfo__bGQEj",modelInfo:"VulnerabilityRadar_modelInfo___IbbQ",shareButton:"VulnerabilityRadar_shareButton__cULHw","recharts-text":"VulnerabilityRadar_recharts-text__WTr68"}},77059:(e,a,s)=>{Promise.resolve().then(s.bind(s,47944))},88175:e=>{e.exports={overview:"ScanOverview_overview__I_0Gq",progress:"ScanOverview_progress__3QOLn",progressValue:"ScanOverview_progressValue__6_P8W",details:"ScanOverview_details__lK18D",detailItem:"ScanOverview_detailItem__kVJje"}},99590:e=>{e.exports={categories:"RiskCategories_categories__X_l3Y",category:"RiskCategories_category__Gm6yt",categoryHeader:"RiskCategories_categoryHeader__EMdqz",categoryTitle:"RiskCategories_categoryTitle__zFSWG",score:"RiskCategories_score__PCarA",arrow:"RiskCategories_arrow__LMEW9",categoryDetails:"RiskCategories_categoryDetails__Frwy9",failureCard:"RiskCategories_failureCard__OS_bU",failure:"RiskCategories_failure__46zj0",failureHeader:"RiskCategories_failureHeader__iBgQU",failureContent:"RiskCategories_failureContent__JU50R",noFailures:"RiskCategories_noFailures__052j2",subcategory:"RiskCategories_subcategory__ajydq",promptSection:"RiskCategories_promptSection__s_UB8",input:"RiskCategories_input__uCzMH",answer:"RiskCategories_answer__et9IO",imageContainer:"RiskCategories_imageContainer__G9b_x",contentText:"RiskCategories_contentText__CVQJY",answerText:"RiskCategories_answerText__6yHpe",contentImage:"RiskCategories_contentImage__zvpiz",subcategoryChart:"RiskCategories_subcategoryChart__eGScY",riskCategoryRadarChart:"RiskCategories_riskCategoryRadarChart__V5DY2",riskCategoryBarChartContainer:"RiskCategories_riskCategoryBarChartContainer__DBsiu"}}},e=>{var a=a=>e(e.s=a);e.O(0,[770,802,766,874,201,808,441,684,358],()=>a(77059)),_N_E=e.O()}]);