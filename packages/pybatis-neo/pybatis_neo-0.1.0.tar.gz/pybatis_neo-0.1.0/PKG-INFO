Metadata-Version: 2.4
Name: pybatis-neo
Version: 0.1.0
Summary: FastAPIë¥¼ ìœ„í•œ MyBatis ìŠ¤íƒ€ì¼ì˜ SQL ë§¤í¼ - í˜„ëŒ€ì ì´ê³  Pythonicí•œ êµ¬í˜„
Project-URL: Homepage, https://github.com/pybatis/pybatis-neo
Project-URL: Documentation, https://pybatis-neo.readthedocs.io
Project-URL: Repository, https://github.com/pybatis/pybatis-neo
Project-URL: Issues, https://github.com/pybatis/pybatis-neo/issues
Project-URL: Changelog, https://github.com/pybatis/pybatis-neo/blob/main/CHANGELOG.md
Author-email: pyBatis Neo Contributors <pybatis.neo@example.com>
Maintainer-email: pyBatis Neo Contributors <pybatis.neo@example.com>
License: MIT
License-File: LICENSE
Keywords: async,database,fastapi,mapper,mybatis,pydantic,sql
Classifier: Development Status :: 4 - Beta
Classifier: Framework :: FastAPI
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Topic :: Database
Classifier: Topic :: Internet :: WWW/HTTP :: Dynamic Content
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.11
Requires-Dist: fastapi>=0.104.0
Requires-Dist: pydantic>=2.0.0
Requires-Dist: typing-extensions>=4.0.0
Provides-Extra: all
Requires-Dist: aiomysql>=0.2.0; extra == 'all'
Requires-Dist: aiosqlite>=0.19.0; extra == 'all'
Requires-Dist: asyncpg>=0.28.0; extra == 'all'
Provides-Extra: dev
Requires-Dist: black>=23.0.0; extra == 'dev'
Requires-Dist: build>=0.10.0; extra == 'dev'
Requires-Dist: flake8>=6.0.0; extra == 'dev'
Requires-Dist: isort>=5.12.0; extra == 'dev'
Requires-Dist: mypy>=1.0.0; extra == 'dev'
Requires-Dist: pytest-asyncio>=0.21.0; extra == 'dev'
Requires-Dist: pytest-cov>=4.0.0; extra == 'dev'
Requires-Dist: pytest>=7.0.0; extra == 'dev'
Requires-Dist: twine>=4.0.0; extra == 'dev'
Provides-Extra: mysql
Requires-Dist: aiomysql>=0.2.0; extra == 'mysql'
Provides-Extra: postgres
Requires-Dist: asyncpg>=0.28.0; extra == 'postgres'
Provides-Extra: sqlite
Requires-Dist: aiosqlite>=0.19.0; extra == 'sqlite'
Description-Content-Type: text/markdown

# ğŸ pyBatis Neo

**FastAPIë¥¼ ìœ„í•œ MyBatis ìŠ¤íƒ€ì¼ì˜ SQL ë§¤í¼ - í˜„ëŒ€ì ì´ê³  Pythonicí•œ êµ¬í˜„**

pyBatis NeoëŠ” FastAPI ë°±ì—”ë“œ ê°œë°œìë¥¼ ìœ„í•œ ì˜¤í”ˆì†ŒìŠ¤ SQL ë§¤í¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. Javaì˜ MyBatisì—ì„œ ì˜ê°ì„ ë°›ì•„, XML ì—†ì´ë„ SQLì„ ëª…ì‹œì ìœ¼ë¡œ ì‘ì„±í•˜ê³ , ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ë¶„ë¦¬í•˜ì—¬ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

## âœ¨ ì£¼ìš” íŠ¹ì§•

- ğŸš€ **FastAPI ì™„ë²½ í†µí•©**: FastAPIì˜ ì˜ì¡´ì„± ì£¼ì… ì‹œìŠ¤í…œê³¼ ìì—°ìŠ¤ëŸ½ê²Œ í†µí•©
- ğŸ”„ **ë¹„ë™ê¸° ì§€ì›**: async/awaitë¥¼ í™œìš©í•œ ê³ ì„±ëŠ¥ ë¹„ë™ê¸° SQL ì‹¤í–‰
- ğŸ¯ **Pydantic ëª¨ë¸ ë§¤í•‘**: SQL ì¿¼ë¦¬ ê²°ê³¼ë¥¼ ìë™ìœ¼ë¡œ Pydantic ëª¨ë¸ë¡œ ë³€í™˜
- ğŸ **Pythonicí•œ êµ¬ì„±**: XML ëŒ€ì‹  ë°ì½”ë ˆì´í„°ì™€ í•¨ìˆ˜ ì£¼ì„ì„ í™œìš©
- ğŸ”’ **SQL ì¸ì ì…˜ ë°©ì§€**: ì•ˆì „í•œ íŒŒë¼ë¯¸í„° ë°”ì¸ë”©
- ğŸ§ª **í…ŒìŠ¤íŠ¸ ì¹œí™”ì **: ëª¨í‚¹ ë° ì˜ì¡´ì„± ì£¼ì…ì„ í†µí•œ ì‰¬ìš´ í…ŒìŠ¤íŠ¸
- ğŸ“Š **ì¿¼ë¦¬ ëª¨ë‹ˆí„°ë§**: ì‹¤í–‰ ì‹œê°„ ì¸¡ì • ë° ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
- ğŸ“ **SQL íŒŒì¼ ë¡œë”**: ì™¸ë¶€ .sql íŒŒì¼ì—ì„œ SQL ë¬¸ ë¡œë“œ

## ğŸ“‹ ìš”êµ¬ì‚¬í•­

- **Python 3.11 ì´ìƒ**
- FastAPI 0.104.0 ì´ìƒ
- Pydantic 2.0.0 ì´ìƒ

## ğŸ“¦ ì„¤ì¹˜

```bash
pip install pybatis-neo
```

### ë°ì´í„°ë² ì´ìŠ¤ ë“œë¼ì´ë²„ ì„¤ì¹˜

```bash
# PostgreSQL
pip install pybatis-neo[postgres]

# MySQL
pip install pybatis-neo[mysql]

# SQLite
pip install pybatis-neo[sqlite]

# ëª¨ë“  ë“œë¼ì´ë²„
pip install pybatis-neo[all]
```

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. ëª¨ë¸ ì •ì˜

```python
from pydantic import BaseModel

class User(BaseModel):
    id: int
    name: str
    email: str
    is_active: bool
```

### 2. Repository í´ë˜ìŠ¤ ìƒì„±

```python
from typing import Optional, List
from pybatis import PyBatis
from .models import User

class UserRepository:
    def __init__(self, db: PyBatis):
        self.db = db

    async def create_user(self, name: str, email: str, is_active: bool = True) -> int:
        return await self.db.execute(
            """
            INSERT INTO users (name, email, is_active)
            VALUES (:name, :email, :is_active)
            """,
            params={
            "name": name,
            "email": email,
            "is_active": is_active})

    async def get_user_by_id(self, user_id: int) -> Optional[User]:
        row = await self.db.fetch_one(
            """
            SELECT id, name, email, is_active
            FROM users
            WHERE id = :user_id
            """,
            params={"user_id": user_id})
        return User(**row) if row else None

    async def get_users_by_activity(self, active_status: bool) -> List[User]:
        rows = await self.db.fetch_all(
            """
            SELECT id, name, email, is_active
            FROM users
            WHERE is_active = :active_status
            """,
            params={"active_status": active_status})
        return [User(**row) for row in rows]

    async def count_active(self, active: bool) -> int:
        return await self.db.fetch_val(
            """
            SELECT COUNT(*)
            FROM users
            WHERE is_active = :active
            """,
            params={"active": active})
```

### 3. FastAPIì™€ í†µí•© (ê¸°ë³¸)

```python
from fastapi import FastAPI
from pybatis import PyBatis

app = FastAPI()

# ê°„ë‹¨í•œ ì‚¬ìš©ë²•
@app.on_event("startup")
async def startup():
    global db
    db = PyBatis(dsn="sqlite:///example.db")
    await db.connect()

@app.get("/users/{user_id}")
async def get_user(user_id: int):
    repo = UserRepository(db)
    user = await repo.get_user_by_id(user_id)
    if not user:
        raise HTTPException(status_code=404, detail="User not found")
    return user
```

### 4. FastAPIì™€ í†µí•© (ê³ ê¸‰ - ì˜ì¡´ì„± ì£¼ì…)

```python
from contextlib import asynccontextmanager
from fastapi import FastAPI, Depends, HTTPException
from pybatis import PyBatis
from pybatis.fastapi import PyBatisManager, create_pybatis_dependency

# PyBatis ë§¤ë‹ˆì € ì„¤ì •
manager = PyBatisManager(dsn="sqlite:///example.db")
get_pybatis = create_pybatis_dependency(manager)

# Repository ì˜ì¡´ì„± í•¨ìˆ˜
async def get_user_repository(pybatis: PyBatis = Depends(get_pybatis)) -> UserRepository:
    return UserRepository(pybatis)

# ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒëª…ì£¼ê¸° ê´€ë¦¬
@asynccontextmanager
async def lifespan(app: FastAPI):
    # ì‹œì‘ ì‹œ: í…Œì´ë¸” ìƒì„±
    async with manager.get_pybatis() as pybatis:
        await pybatis.execute("""
            CREATE TABLE IF NOT EXISTS users (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                name TEXT NOT NULL,
                email TEXT UNIQUE NOT NULL,
                is_active BOOLEAN DEFAULT TRUE
            )
        """)
    yield
    # ì¢…ë£Œ ì‹œ: ë¦¬ì†ŒìŠ¤ ì •ë¦¬
    await manager.close()

app = FastAPI(lifespan=lifespan)

@app.get("/users/{user_id}")
async def get_user(
    user_id: int,
    user_repo: UserRepository = Depends(get_user_repository)
):
    user = await user_repo.get_user_by_id(user_id)
    if not user:
        raise HTTPException(status_code=404, detail="User not found")
    return user

@app.get("/users/active-count")
async def active_users_count(
    user_repo: UserRepository = Depends(get_user_repository)
):
    count = await user_repo.count_active(active=True)
    return {"active_user_count": count}
```

## ğŸ”§ ê³ ê¸‰ ê¸°ëŠ¥

### ì¿¼ë¦¬ ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§

```python
# ì¿¼ë¦¬ ë¡œê¹… í™œì„±í™”
db.enable_query_logging(level=logging.INFO)

# ì¿¼ë¦¬ ëª¨ë‹ˆí„°ë§ í™œì„±í™”
db.enable_query_monitoring()

# ëŠë¦° ì¿¼ë¦¬ ì„ê³„ê°’ ì„¤ì • (1ì´ˆ)
db.set_slow_query_threshold(1.0)

# í†µê³„ ì¡°íšŒ
stats = db.get_query_stats()
print(f"ì´ ì¿¼ë¦¬ ìˆ˜: {stats['total_queries']}")
print(f"í‰ê·  ì‹¤í–‰ ì‹œê°„: {stats['average_execution_time']:.4f}ì´ˆ")
```

### íŠ¸ëœì­ì…˜ ê´€ë¦¬

```python
# íŠ¸ëœì­ì…˜ ì»¨í…ìŠ¤íŠ¸ ë§¤ë‹ˆì € ì‚¬ìš©
async with db.transaction() as tx:
    await tx.execute("INSERT INTO users (name) VALUES (:name)", {"name": "ì‚¬ìš©ì1"})
    await tx.execute("INSERT INTO profiles (user_id) VALUES (:user_id)", {"user_id": 1})
    # ìë™ ì»¤ë°‹ (ì˜ˆì™¸ ë°œìƒ ì‹œ ìë™ ë¡¤ë°±)
```

### SQL íŒŒì¼ ë¡œë”

```python
# SQL ë””ë ‰í† ë¦¬ ì„¤ì •
db.set_sql_loader_dir("sql/")

# SQL íŒŒì¼ì—ì„œ ë¡œë“œ
sql = db.load_sql("users.sql", "get_active_users")
users = await db.fetch_all(sql, {"active": True})
```

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

pyBatisëŠ” ë‹¤ìŒê³¼ ê°™ì€ í•µì‹¬ ì»´í¬ë„ŒíŠ¸ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:

- **PyBatis**: í•µì‹¬ SQL ì‹¤í–‰ê¸° í´ë˜ìŠ¤
- **Repository Pattern**: ë„ë©”ì¸ë³„ ë°ì´í„° ì•¡ì„¸ìŠ¤ ë¡œì§ ìº¡ìŠí™”
- **DSN ì—°ê²°**: ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë¬¸ìì—´ ê¸°ë°˜ ì´ˆê¸°í™”
- **ë¹„ë™ê¸° ì§€ì›**: async/awaitë¥¼ í™œìš©í•œ ê³ ì„±ëŠ¥ SQL ì‹¤í–‰
- **FastAPI í†µí•©**: ì˜ì¡´ì„± ì£¼ì… ë° ìƒëª…ì£¼ê¸° ê´€ë¦¬

## ğŸ§ª ê°œë°œ í™˜ê²½ ì„¤ì •

í”„ë¡œì íŠ¸ë¥¼ ë¡œì»¬ì—ì„œ ê°œë°œí•˜ë ¤ë©´:

```bash
# ì €ì¥ì†Œ í´ë¡ 
git clone https://github.com/pybatis/pybatis.git
cd pybatis

# ê°€ìƒí™˜ê²½ ìƒì„± (uv ì‚¬ìš©)
uv venv
source .venv/bin/activate

# ê°œë°œ ì˜ì¡´ì„± ì„¤ì¹˜
uv pip install -e ".[dev]"

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
uv run pytest

# ì½”ë“œ í¬ë§·íŒ…
black src tests
isort src tests

# íƒ€ì… ì²´í¬
mypy src

# ìƒ˜í”Œ ì½”ë“œ ì‹¤í–‰
python samples/demo_sqlite_pydantic.py
python samples/fastapi_example.py
```

## ğŸ“Š í…ŒìŠ¤íŠ¸

```bash
# ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰
uv run pytest

# ì»¤ë²„ë¦¬ì§€ í¬í•¨ í…ŒìŠ¤íŠ¸
uv run pytest --cov=pybatis --cov-report=html

# íŠ¹ì • í…ŒìŠ¤íŠ¸ íŒŒì¼ ì‹¤í–‰
uv run pytest tests/test_pybatis.py
```

## ğŸ“š ìƒ˜í”Œ ì½”ë“œ

`samples/` ë””ë ‰í† ë¦¬ì—ì„œ ë‹¤ì–‘í•œ ì‚¬ìš© ì˜ˆì œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- `demo_sqlite_pydantic.py`: SQLiteì™€ Pydantic ëª¨ë¸ ì—°ë™ ë°ëª¨
- `fastapi_example.py`: FastAPI ì™„ì „ í†µí•© ì˜ˆì œ

## ğŸ¤ ê¸°ì—¬í•˜ê¸°

pyBatisëŠ” ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. ê¸°ì—¬ë¥¼ í™˜ì˜í•©ë‹ˆë‹¤!

1. ì´ìŠˆë¥¼ í™•ì¸í•˜ê±°ë‚˜ ìƒˆë¡œìš´ ì´ìŠˆë¥¼ ìƒì„±í•˜ì„¸ìš”
2. í”¼ì²˜ ë¸Œëœì¹˜ë¥¼ ìƒì„±í•˜ì„¸ìš” (`git checkout -b feature/amazing-feature`)
3. ë³€ê²½ì‚¬í•­ì„ ì»¤ë°‹í•˜ì„¸ìš” (`git commit -m 'Add amazing feature'`)
4. ë¸Œëœì¹˜ì— í‘¸ì‹œí•˜ì„¸ìš” (`git push origin feature/amazing-feature`)
5. Pull Requestë¥¼ ìƒì„±í•˜ì„¸ìš”

## ğŸ“ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” MIT ë¼ì´ì„ ìŠ¤ í•˜ì— ìˆìŠµë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [LICENSE](LICENSE) íŒŒì¼ì„ ì°¸ì¡°í•˜ì„¸ìš”.

## ğŸ”— ë§í¬

- [ë¬¸ì„œ](https://pybatis.readthedocs.io)
- [GitHub ì €ì¥ì†Œ](https://github.com/pybatis/pybatis)
- [ì´ìŠˆ íŠ¸ë˜ì»¤](https://github.com/pybatis/pybatis/issues)
- [PyPI](https://pypi.org/project/pybatis/)
