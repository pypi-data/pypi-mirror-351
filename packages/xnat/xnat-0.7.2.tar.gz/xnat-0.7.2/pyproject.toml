[build-system]
requires = ["hatchling", "versioningit"]
build-backend = "hatchling.build"

[project]
name = "xnat"
dynamic = ["version"]
description = "An XNAT client that exposes the XNAT REST interface as python objects. Part of the interface is automatically generated based on the servers data model as defined by the xnat schema."
readme = "README.rst"
license = {file = "LICENSE"}
authors = [
    { name = "H.C. Achterberg", email = "hakim.achterberg@gmail.com" },
]
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "Intended Audience :: Healthcare Industry",
    "Intended Audience :: Science/Research",
    "License :: OSI Approved :: Apache Software License",
    "Natural Language :: English",
    "Programming Language :: Python :: 3.8",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Topic :: Scientific/Engineering :: Bio-Informatics",
    "Topic :: Scientific/Engineering :: Medical Science Apps.",
]
dependencies = [
    "click-option-group~=0.5.6",
    "click~=8.0",
    "importlib_metadata~=6.8",
    "isodate~=0.6",
    "progressbar2~=4.2",
    "pydicom~=2.3",
    "python-dateutil~=2.8.2",
    "PyYAML~=6.0",
    "requests~=2.30",
]

[project.scripts]
xnat = "xnat.cli:cli"
xnat_cp_project = "xnat.scripts.copy_project:main"
xnat_data_integrity-check = "xnat.scripts.data_integrity_check:main"

[project.urls]
"CI/CD" = "https://gitlab.com/radiology/infrastructure/xnatpy/-/pipelines"
Changelog = "https://xnat.readthedocs.io/en/latest/static/changelog.html"
Documentation = "https://xnat.readthedocs.io"
Download = "https://gitlab.com/radiology/infrastructure/xnatpy/-/archive/master/xnatpy-master.zip"
Homepage = "https://gitlab.com/radiology/infrastructure/xnatpy"
Issues = "https://gitlab.com/radiology/infrastructure/xnatpy/-/issues"

[tool.hatch.build.targets.wheel]
exclude = [
  "xnat/tests",
]

[tool.hatch.version]
source = "versioningit"

[tool.hatch.version.format]
distance = "{base_version}.post{distance}.dev0"

[tool.hatch.version.write]
file = 'xnat/version.py'
template = """
# This file is automatically generated by versioningit during build stage. Do not edit it manually.
# Configuration is stored in the pyproject.toml file.

version = '{version}'
version_tuple = {version_tuple}
base_version = '{base_version}'  # Latest released version known at build time
git_revision = '{rev}'
git_revision_full = '{revision}'
git_branch = '{branch}'
git_revision_date = '{author_date:%Y-%m-%dT%H:%M:%S}'
build_date = '{build_date:%Y-%m-%dT%H:%M:%S}'
"""

[tool.hatch.build]
artifacts = ["xnat/version.py"]

[tool.hatch.build.targets.sdist]
include = [
    "/xnat",
]

[tool.hatch.envs.default]
installer = "uv"

[tool.hatch.envs.hatch-test]
installer = "uv"
default-args = ["xnat", "-vv"]
extra-dependencies = [
    "pytest-cov>=4.0.0",
    "pytest-mock>=3.10.0",
    "requests-mock>=1.10.0",
    "xnat4tests==0.3.11",
]

[tool.black]
line_length = 120

[tool.isort]
profile = "black"
line_length = 120
